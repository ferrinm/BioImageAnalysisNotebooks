<<e970f606-b58f-4560-b555-3383257e70f9>>
* Surface measurements
  :PROPERTIES:
  :CUSTOM_ID: surface-measurements
  :END:
In this notebook we demonstrate how to retrieve surface/vertex
measurements in a table and how to visualize them on the surface. The
used example data is derived from
[[https://zenodo.org/record/7603081#.Y94N4XbMJmN][AV Luque and JV
Veenvliet (2023)]] licensed
[[https://creativecommons.org/licenses/by/4.0/legalcode][CC-BY]]. See
the [[file:creating_surfaces.ipynb][creating_surfaces notebook]] for how
to create the surface from raw imaging data.

See also

- [[https://vedo.embl.es/][vedo library]]
- [[https://vedo.embl.es/autodocs/content/vedo/mesh.html?highlight=curvature#vedo.mesh.Mesh.addCurvatureScalars][vedo
  add curvature documentation]]

<<33f515ba-b872-45db-99f8-ad33193d0658>>
#+begin_src python
import napari
import matplotlib.pyplot as plt
from napari.utils import nbscreenshot
import numpy as np
import vedo
from napari_process_points_and_surfaces import add_curvature, Curvature, spherefitted_curvature
import napari_process_points_and_surfaces as nppas

import vedo
#+end_src

<<dac56fba-a1ce-4b80-8ce0-b236bfb60d25>>
#+begin_src python
viewer = napari.Viewer(ndisplay=3)
viewer.camera.angles = (40, -30, 55)
#+end_src

<<695a71bb-002f-4695-9e06-fc6cf12f4f79>>
#+begin_src python
surface = nppas.gastruloid()
#+end_src

#+begin_example
The nppas gastruloid example is derived from AV Luque and JV Veenvliet (2023) which is licensed CC-BY (https://creativecommons.org/licenses/by/4.0/legalcode) and can be downloaded from here: https://zenodo.org/record/7603081
#+end_example

<<90de7074-edcc-43b9-a451-e997e5d8a5c8>>
** Surface visualization
   :PROPERTIES:
   :CUSTOM_ID: surface-visualization
   :END:
The surface itself does not come with any quantification. It looks like
this:

<<4d0db4af-a6ce-4b7e-b834-4082435bd02a>>
#+begin_src python
surface
#+end_src

#+begin_example
(array([[ 14.174363, 220.40599 , 224.08286 ],
        [ 13.983076, 208.15877 , 220.32153 ],
        [ 14.819012, 219.06023 , 229.4558  ],
        ...,
        [112.18208 , 356.98364 , 430.36832 ],
        [112.3784  , 360.45856 , 421.8425  ],
        [112.865425, 352.2561  , 422.1735  ]], dtype=float32),
 array([[   0,    1,    2],
        [   3,    4,    5],
        [   6,    4,    7],
        ...,
        [3318, 3317, 3316],
        [3316, 3323, 3318],
        [3318, 3323, 3319]], dtype=int64))
#+end_example

<<01709465-0d6a-4b1b-9966-dc47c72f5002>>
** Quantification
   :PROPERTIES:
   :CUSTOM_ID: quantification
   :END:
We can create a table
([[https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html][pandas
Dataframe]]) like this.

<<494e364a-b57a-4da4-b024-fb03b0cbe693>>
#+begin_src python
requested_measurements = [nppas.Quality.AREA, 
                          nppas.Quality.ASPECT_RATIO,
                          nppas.Quality.GAUSS_CURVATURE, 
                          nppas.Quality.MEAN_CURVATURE,
                          nppas.Quality.SPHERE_FITTED_CURVATURE_DECA_VOXEL,
                          nppas.Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL,
                          nppas.Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL,
                         ]

df = nppas.surface_quality_table(surface, requested_measurements)
df
#+end_src

#+begin_example
      vertex_index  Quality.AREA  Quality.ASPECT_RATIO  \
0                0     29.997389              1.600400   
1                1     46.087046              1.602183   
2                2     35.886338              1.400599   
3                3     22.887296              1.751932   
4                4     29.952347              1.220882   
...            ...           ...                   ...   
3319          3319     25.079661              1.340802   
3320          3320     47.213916              1.254924   
3321          3321     35.964707              1.140267   
3322          3322     45.673529              1.189562   
3323          3323     30.105530              1.151230   

      Quality.GAUSS_CURVATURE  Quality.MEAN_CURVATURE  \
0                    0.030287                0.000490   
1                    0.011136                0.000018   
2                    0.012633                0.000142   
3                    0.036979                0.000548   
4                    0.010277                0.000047   
...                       ...                     ...   
3319                 0.031878                0.000606   
3320                 0.004615                0.000003   
3321                 0.015661                0.000198   
3322                 0.011380                0.000100   
3323                 0.014396                0.000190   

      Quality.SPHERE_FITTED_CURVATURE_DECA_VOXEL  \
0                                       0.000691   
1                                            NaN   
2                                       0.000542   
3                                       0.000339   
4                                       0.000366   
...                                          ...   
3319                                    0.001081   
3320                                         NaN   
3321                                    0.000547   
3322                                    0.000026   
3323                                    0.000158   

      Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL  \
0                                        0.000257   
1                                        0.000250   
2                                        0.000253   
3                                        0.000379   
4                                        0.000391   
...                                           ...   
3319                                     0.000168   
3320                                     0.000169   
3321                                     0.000163   
3322                                     0.000152   
3323                                     0.000163   

      Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL  
0                                       0.000019  
1                                       0.000019  
2                                       0.000019  
3                                       0.000019  
4                                       0.000019  
...                                          ...  
3319                                    0.000019  
3320                                    0.000019  
3321                                    0.000019  
3322                                    0.000019  
3323                                    0.000019  

[3324 rows x 8 columns]
#+end_example

<<4b116469-1979-4dad-8b49-012fd46c0043>>
To get an overview about measurements, we can summarize them:

<<6b8484d5-6606-4969-8e60-21751049746a>>
#+begin_src python
df.describe().T
#+end_src

#+begin_example
                                              count         mean         std  \
vertex_index                                 3324.0  1661.500000  959.700474   
Quality.AREA                                 3324.0    33.753233   10.790780   
Quality.ASPECT_RATIO                         3324.0     7.126810   89.909602   
Quality.GAUSS_CURVATURE                      3324.0     0.016958    0.035275   
Quality.MEAN_CURVATURE                       3324.0     0.000383    0.007653   
Quality.SPHERE_FITTED_CURVATURE_DECA_VOXEL   2750.0     0.002875    0.004761   
Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL  3324.0     0.000258    0.000069   
Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL   3324.0     0.000019    0.000000   

                                                      min         25%  \
vertex_index                                 0.000000e+00  830.750000   
Quality.AREA                                 5.677486e+00   26.694735   
Quality.ASPECT_RATIO                         1.038034e+00    1.292444   
Quality.GAUSS_CURVATURE                     -1.031106e+00    0.005509   
Quality.MEAN_CURVATURE                      -2.803460e-02   -0.000135   
Quality.SPHERE_FITTED_CURVATURE_DECA_VOXEL   1.791201e-09    0.000341   
Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL  1.516446e-04    0.000214   
Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL   1.853513e-05    0.000019   

                                                     50%          75%  \
vertex_index                                 1661.500000  2492.250000   
Quality.AREA                                   32.956835    39.255080   
Quality.ASPECT_RATIO                            1.437911     1.648299   
Quality.GAUSS_CURVATURE                         0.013645     0.024739   
Quality.MEAN_CURVATURE                          0.000010     0.000270   
Quality.SPHERE_FITTED_CURVATURE_DECA_VOXEL      0.001004     0.003054   
Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL     0.000241     0.000275   
Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL      0.000019     0.000019   

                                                     max  
vertex_index                                 3323.000000  
Quality.AREA                                  125.564101  
Quality.ASPECT_RATIO                         3421.965459  
Quality.GAUSS_CURVATURE                         0.348243  
Quality.MEAN_CURVATURE                          0.426018  
Quality.SPHERE_FITTED_CURVATURE_DECA_VOXEL      0.043508  
Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL     0.000545  
Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL      0.000019  
#+end_example

<<acaccf82-910d-4fb5-a208-0e03825fe41f>>
We can extract a single column for the table as list.

<<d57d4e93-9a21-471e-a18d-1a19fa2cda47>>
#+begin_src python
curvature = list(df['Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL'])
curvature[:5]
#+end_src

#+begin_example
[0.0002572409502622459,
 0.0002504286604301336,
 0.00025319922419934937,
 0.00037887302369609083,
 0.00039058361737075804]
#+end_example

<<5719b476-e642-4e8f-8ae2-03d7a86c34dc>>
** Visualizing measurements
   :PROPERTIES:
   :CUSTOM_ID: visualizing-measurements
   :END:
To visualize the measurements, we need to attach them to the surface:

<<712fb8bb-6e32-47f6-af13-c35140fcf6f0>>
#+begin_src python
quantified_surface = nppas.set_vertex_values(surface, curvature)
quantified_surface
#+end_src

#+begin_example
(array([[ 14.174363, 220.40599 , 224.08286 ],
        [ 13.983076, 208.15877 , 220.32153 ],
        [ 14.819012, 219.06023 , 229.4558  ],
        ...,
        [112.18208 , 356.98364 , 430.36832 ],
        [112.3784  , 360.45856 , 421.8425  ],
        [112.865425, 352.2561  , 422.1735  ]], dtype=float32),
 array([[   0,    1,    2],
        [   3,    4,    5],
        [   6,    4,    7],
        ...,
        [3318, 3317, 3316],
        [3316, 3323, 3318],
        [3318, 3323, 3319]], dtype=int64),
 [0.0002572409502622459,
  0.0002504286604301336,
  0.00025319922419934937,
  0.00037887302369609083,
  0.00039058361737075804,
  0.0003600190769892588,
  0.0003812024121276196,
  0.0004032213994721877,
  0.00026615657793863437,
  0.00027205340748381396,
  0.0002614592926650137,
  0.0002535430610115366,
  0.0002444765111638357,
  0.0002573608283640385,
  0.00025511530868667414,
  0.0004272923050341968,
  0.00040987382053132507,
  0.00041509675552257603,
  0.0003926723802985403,
  0.0003564980324540298,
  0.0003623340736194096,
  0.00033555980471592983,
  0.0003317364998374916,
  0.0002921858820893961,
  0.0002892736862261418,
  0.00027213123062221344,
  0.0002739698532122773,
  0.00025648820850162154,
  0.00026122497221375764,
  0.00024782755218819214,
  0.0002649861975374232,
  0.00026065427276901183,
  0.00025244832393795237,
  0.00019891824369307795,
  0.00020176570801880932,
  0.00020818338902591803,
  0.00018501914963072087,
  0.00020767594689551926,
  0.00016904129858439523,
  0.00016712948796036094,
  0.00016842769309972517,
  0.0001751982557912654,
  0.0001731369728536228,
  0.00016952163872836523,
  0.000170649889272481,
  0.00018770825158857248,
  0.00018521431489318174,
  0.00019235238150829454,
  0.00019944375347912574,
  0.00019322146916632733,
  0.00042728800312801315,
  0.00036595568013041336,
  0.00031320856763767855,
  0.00034012045863710265,
  0.0003050005826347762,
  0.0003164459041932456,
  0.00031649243860784517,
  0.00027174891061767636,
  0.00029662462724188864,
  0.0002696932569205914,
  0.0002444676930201564,
  0.0002621616186653647,
  0.00026243819527401125,
  0.00025959623392583136,
  0.00025367576832567974,
  0.00021426165097631434,
  0.00021748433662969354,
  0.00020409808637693932,
  0.00021400356548413585,
  0.0001921425944834943,
  0.00020509266063909186,
  0.00018253946206721675,
  0.00017454589420488024,
  0.00017135001431061556,
  0.0001769410406399325,
  0.00017555981577485697,
  0.00017827199115258026,
  0.0001703851425855177,
  0.00016902580168181794,
  0.0001762321945163552,
  0.00017687534888938706,
  0.0001705892258722087,
  0.00017349616890782797,
  0.00017501710140030425,
  0.0001711842334784097,
  0.00016930807656340564,
  0.00017071925196267146,
  0.00017425498392505828,
  0.00017100156134874575,
  0.0001716349011546965,
  0.0001790206863094092,
  0.00019059228511976467,
  0.00019238854230643572,
  0.00018288453196148272,
  0.0001836472132901217,
  0.00018684970100970558,
  0.00018964790911978177,
  0.00020123963422510893,
  0.00019707816680708513,
  0.0002078212392407102,
  0.00021144493983045272,
  0.00020766151378358928,
  0.00043871883709428906,
  0.00040097676857697105,
  0.00040662380031037033,
  0.0004314457029678715,
  0.0003590238662584835,
  0.00033060318372179733,
  0.0003245627629890231,
  0.00030022028491949373,
  0.0002906755126752112,
  0.0003200366450220646,
  0.00026208411361707375,
  0.00026167378368374976,
  0.0002676546483723617,
  0.00026423069699332526,
  0.0002521125183349993,
  0.0002562409452488081,
  0.00026524211845965203,
  0.00025775642775682767,
  0.000252782607215831,
  0.00025110836335157923,
  0.00025872755321448306,
  0.00025254256576958366,
  0.00022029583494938282,
  0.00022296007794809223,
  0.00022531952897482963,
  0.0001959227869320106,
  0.00018939128164285746,
  0.0001976808850114822,
  0.00019178025721304924,
  0.00018047807205775408,
  0.00019168217514391398,
  0.00018546494971022982,
  0.00017275094305277872,
  0.00017394261253750388,
  0.00017215937281241794,
  0.00016934863406256278,
  0.00017039086704815544,
  0.000179161967940479,
  0.00017408272121488622,
  0.0001784763411953924,
  0.00019923055875452946,
  0.00020583931034030766,
  0.00020088079365537646,
  0.0001770723068547297,
  0.00018225260790297147,
  0.00018366697579101583,
  0.0001839510420424569,
  0.0001900939360988348,
  0.00019110734362946032,
  0.00019610864946439422,
  0.00020264192382936456,
  0.00019081470976941027,
  0.00019114496805874132,
  0.00019340424663037023,
  0.00019099879998778652,
  0.00019304700025687426,
  0.00020887981738006167,
  0.00021266638267707685,
  0.00020125842184442856,
  0.0002198466152579219,
  0.000211652871964054,
  0.0002197386460756112,
  0.0004677682191886942,
  0.0004485669145226248,
  0.00040752902455997147,
  0.0003390299941593314,
  0.00028404249098983844,
  0.00027518482958564897,
  0.0002896627997687166,
  0.0002456891868902547,
  0.0002681408415991737,
  0.00025067018142539867,
  0.0002512695045502955,
  0.0002701620061581648,
  0.0002655611142414452,
  0.00024298182086813093,
  0.00022854622737873925,
  0.00022030626047607344,
  0.00021193313569055626,
  0.0002091462387076694,
  0.0001800080434657136,
  0.00019859616873247606,
  0.00019252020511440878,
  0.00018368594108723548,
  0.00020316203870516606,
  0.00017549459849725425,
  0.00020597874538330786,
  0.0002013272531522329,
  0.00018959220848176086,
  0.00016916696832151978,
  0.00017134025718145907,
  0.00020547507585562952,
  0.00020901976820887402,
  0.00018903387781135178,
  0.00018145574402876152,
  0.000189985804672148,
  0.00018162240683690858,
  0.0002033863757283501,
  0.00020887429619843525,
  0.0001821832347974698,
  0.0001962589229486824,
  0.0001897913942551104,
  0.0001985401531980861,
  0.00019890719177776542,
  0.00019626388718686883,
  0.00019473926799475918,
  0.0002103542466126866,
  0.00021647581801231624,
  0.00020151709539160086,
  0.00020960476757555014,
  0.0004680865827822022,
  0.0004364394004867301,
  0.0004595592951647207,
  0.0003257464566911726,
  0.00032070421526581564,
  0.0002723585514864798,
  0.000268696892865781,
  0.0002654160147064434,
  0.00024405239327787893,
  0.0002690032108946295,
  0.0002505572197324324,
  0.00024618174368979653,
  0.00024673034927005945,
  0.0002489148697522014,
  0.00024092942261015802,
  0.00026300275514403,
  0.0002575577364793399,
  0.00022636605863352255,
  0.00022854647798893553,
  0.0001948637995306459,
  0.00022286742621848083,
  0.00021881527513591082,
  0.00020730611758043425,
  0.0001992231981810641,
  0.00021064232363248055,
  0.00019377713682435405,
  0.00020643064689088026,
  0.0002008719455456314,
  0.00019237340812178783,
  0.00018792881671994305,
  0.00018771573198763744,
  0.00019584416363099998,
  0.0001991795912438479,
  0.00020813812780820132,
  0.00020708106437391607,
  0.00020031427336553121,
  0.00020557775599607312,
  0.00019488904542224714,
  0.00021939172353620302,
  0.00021171433130336975,
  0.00022370672286203445,
  0.00021779228626989447,
  0.00023096752733401868,
  0.00022835027566919325,
  0.0004925890345328987,
  0.0004568308854746316,
  0.0003959954922335574,
  0.0003539181545271167,
  0.0003471073570397839,
  0.00031057140758191276,
  0.00026946851758746304,
  0.00024433452063618073,
  0.00027076729947444827,
  0.00024045926616682775,
  0.00023278009270960283,
  0.00024398479587516174,
  0.0002607439132374984,
  0.00023300401688150816,
  0.00025558741228478015,
  0.00022314154903242743,
  0.0002322138400484778,
  0.0002510243108128288,
  0.00022824842447049748,
  0.00022482731564798776,
  0.0002067224126345375,
  0.00018328195821786124,
  0.0001915724091877395,
  0.00019908277327810401,
  0.00019506835700401946,
  0.00018733950559686056,
  0.0002120286697172315,
  0.0002152431300752675,
  0.0001803829318914676,
  0.0001767628635892535,
  0.000211320597096266,
  0.0002055418050857393,
  0.0001973425408520854,
  0.00017435369724464134,
  0.00020939484451786868,
  0.000211420706927273,
  0.00021464810210184695,
  0.00021196849843043447,
  0.00018370178670651773,
  0.00018743849994822575,
  0.0002074917844937917,
  0.00019508415874257604,
  0.00020904511189772428,
  0.0001943279741684541,
  0.0002158007670584427,
  0.00020807304797178155,
  0.00020767100682260017,
  0.0002167101696354535,
  0.0001970981679349099,
  0.00020276080120573957,
  0.00020024925648019448,
  0.00020672057780555262,
  0.00023095006689106455,
  0.0004848296574995058,
  0.0004674311855054691,
  0.00040372563083196567,
  0.00037246807581627056,
  0.00032247610643450214,
  0.00029556910886226006,
  0.00028783765251664135,
  0.00031979280673842374,
  0.00029121756514813155,
  0.00024424046566581483,
  0.0002708491796708014,
  0.0002775801253145731,
  0.00023299848215887207,
  0.00022901485347793764,
  0.00021977873318063142,
  0.00019856388087800478,
  0.00021012918535208476,
  0.0002175784008680612,
  0.00021416363769615528,
  0.00021178157459115368,
  0.0001769012463739894,
  0.00020717543830867227,
  0.00021146139932135254,
  0.00021511855380657835,
  0.00020375154809386102,
  0.00019690477071743022,
  0.00019918127380041487,
  0.00019244984735768776,
  0.00018446176820373098,
  0.00020164929272883085,
  0.000188948628747552,
  0.00021847895642616234,
  0.0002124601361850356,
  0.00021484349499033053,
  0.00023050081373358504,
  0.0004785513525776887,
  0.0004437276459708458,
  0.0004000300341021437,
  0.0003680682160264789,
  0.0002540468259049504,
  0.0002477619009467048,
  0.00024455668161168565,
  0.0002461954020773863,
  0.0002735197530686702,
  0.00023293586987326373,
  0.0002671162757543223,
  0.00027042078898130174,
  0.00024580366463722124,
  0.0002282830077476315,
  0.0002254137200933522,
  0.00020020837618962744,
  0.00022139312047659,
  0.00020326162030947123,
  0.00020481572193654324,
  0.00021423714665912255,
  0.00021846365115006807,
  0.0002076196143975131,
  0.00021409717422447624,
  0.00021783557282483503,
  0.00021631560207095713,
  0.00020571187123612423,
  0.00021868345519124378,
  0.00020087989215241181,
  0.000203864670871373,
  0.00020296023813689488,
  0.00018630534240735876,
  0.00019093239853864525,
  0.00019354134277914064,
  0.00020683107295366312,
  0.00021617546784563892,
  0.0002026985812950964,
  0.00022115907404494413,
  0.00022618868782303987,
  0.00020290714422344284,
  0.000206006031925293,
  0.00021167385491904396,
  0.00023528690498130072,
  0.00047104247685174604,
  0.000429867168622636,
  0.0003484883261250945,
  0.0002717678356971759,
  0.00028373968318662487,
  0.00026849643738122603,
  0.0002406944155251645,
  0.00022792909644537358,
  0.0002746198955107924,
  0.00026344743290613356,
  0.00023846789665759544,
  0.00023412421115363602,
  0.00022796578263638208,
  0.00023408364707552386,
  0.00025779271410664287,
  0.00023234347224350847,
  0.00025673578617008976,
  0.0002188866957639309,
  0.00021326192464307596,
  0.00022372974309412926,
  0.00020302127048166658,
  0.00020127036526929726,
  0.00021927336257086504,
  0.0002129286743448907,
  0.00021698418431459734,
  0.00020855910153671478,
  0.000213626527935413,
  0.00021671154352941163,
  0.00021414072563324824,
  0.0002144810911128365,
  0.00020619398309208755,
  0.0003540718322971417,
  0.0003737574697517392,
  0.00038159921982979883,
  0.00021943285094136927,
  0.00021126111924839203,
  0.0002054056536659378,
  0.00021140543023044723,
  0.000196629619844056,
  0.00022620524800900571,
  0.00022716251049204254,
  0.00020701801625330478,
  0.00023832411071542738,
  0.00023570372065123376,
  0.0004936242376698409,
  0.0005008874555289053,
  0.0004987882103991312,
  0.0004544235564984072,
  0.0004329991697368188,
  0.0004039409287349193,
  0.0002899387422508282,
  0.0003056676591033475,
  0.0002797703802162193,
  0.00027889567344356066,
  0.0002710914258399982,
  0.00026815857806555246,
  0.00023646994734450655,
  0.00023216303417758415,
  0.00020806160792634162,
  0.00020715844146522704,
  0.00021390377341270512,
  0.0002277157889860397,
  0.00023849221690485162,
  0.00025156312704680185,
  0.00020831600730606672,
  0.00021215043695714815,
  0.00022042558604993423,
  0.0002134169801309818,
  0.0002115501335505045,
  0.0003510784000313991,
  0.00038515121868740236,
  0.00032272164531876516,
  0.00039942686065656016,
  0.0004058765481077292,
  0.00020928468606076246,
  0.0003328805556270155,
  0.00036807053491955783,
  0.00039583431297376243,
  0.00021840369557208614,
  0.00022231989252458658,
  0.0002077535077740924,
  0.00019182180461971106,
  0.00022019346892107922,
  0.00022323514323498254,
  0.0002157060704527888,
  0.00022518735182631383,
  0.00021050183024173963,
  0.000220176219418336,
  0.00021796751391267092,
  0.00024101361392781618,
  0.00023832517461081507,
  0.0005036322556339301,
  0.0004772778102402405,
  0.0004609891726911749,
  0.00038567253420681853,
  0.0002596769862224451,
  0.00023180514646430886,
  0.00022481420644006276,
  0.00022220998487999205,
  0.00026377909628459294,
  0.00021410166638829856,
  0.0002296865252288704,
  0.0002407740032504733,
  0.00022078962198304237,
  0.0002238482551101983,
  0.00021593589121782526,
  0.000211772165996848,
  0.00020750000652811014,
  0.00029751070049984917,
  0.00032698725614167085,
  0.00029941344776653663,
  0.0003139940628523766,
  0.000317375970386285,
  0.0003294659583111718,
  0.0003543596687114737,
  0.00041393511923549587,
  0.000398781699281258,
  0.0002129309744811095,
  0.0003774495666309367,
  0.00019702386421036923,
  0.00021489198884819155,
  0.00020101949982671065,
  0.00020386292172789352,
  0.0002177923979423533,
  0.00021994908832602514,
  0.00023484160460734288,
  0.0002103664605442015,
  0.000214162259211629,
  0.00022368959339722373,
  0.00022776959886643895,
  0.0005061701283260562,
  0.0004845695087405329,
  0.0003908862011710765,
  0.0003567753102885303,
  0.00033347773731497415,
  0.00033418743450985307,
  0.0003049986845155221,
  0.0002449441480126751,
  0.00024230991695737948,
  0.0002761672966393639,
  0.0002807966395502792,
  0.0002165015463472109,
  0.0002829571758631551,
  0.0002208120861623881,
  0.0002308025077439555,
  0.0002310959118964013,
  0.00021875889731236332,
  0.00023045216344339285,
  0.00021498393852244563,
  0.00021027293444405768,
  0.0002590191958548301,
  0.00024078670736402358,
  0.0002515707124605538,
  0.00024489468204215794,
  0.0002178206004945423,
  0.00021377892764701365,
  0.00026206649894912673,
  0.0002603611753148455,
  0.00026209622594503673,
  0.0002090098936114718,
  0.0002723931843358936,
  0.00027967723618083535,
  0.00029297046553194674,
  0.0003557233512089595,
  0.00021346341865159896,
  0.00042250682451436657,
  0.00022206349205186504,
  0.0004204288858525923,
  0.00021023908758808805,
  0.00021032583473969756,
  0.00030614792598555917,
  0.00027437557833487683,
  0.00043052080998591546,
  0.00022158045359120594,
  0.0002182041025999566,
  0.0003416835206772788,
  0.00042694172992872875,
  0.00020594390158344475,
  0.0003462007326262369,
  0.00037672287365581513,
  0.0004146535881636774,
  0.0002328499295339527,
  0.0002332323296908743,
  0.00021972160600376844,
  0.0002157716040183795,
  0.00021527578457988298,
  0.0002389446188047464,
  0.00021950322556961097,
  0.00023619766358687875,
  0.00042466268708135245,
  0.00037488607409613163,
  0.00030037897450994346,
  0.0002460925754689037,
  0.00028696485803614074,
  0.00021640824707501403,
  0.00021646219149630522,
  0.000214361480246057,
  0.0002210477972801031,
  0.00021791880348705697,
  0.00026122296286878885,
  0.000215052573426472,
  0.00022667553736504896,
  0.00021657796217294345,
  0.00022958962760395623,
  0.00024274865121975123,
  0.00021989787026697473,
  0.00022083734975652147,
  0.0002636557932843539,
  0.00026281891010241005,
  0.00026463375356741383,
  0.00025554153894324276,
  0.0002552411325259498,
  0.00020882821370390832,
  0.00025772556065805643,
  0.00021565669362135946,
  0.00027697492557453865,
  0.00030449640890108147,
  0.00033262677476065037,
  0.00021912058449336856,
  0.00021201772297969561,
  0.00025596173881222003,
  0.0004208288241449341,
  0.00040470176641227895,
  0.00020839854775189958,
  0.0004446489654888554,
  0.00045458421526826595,
  0.0002096478624118752,
  0.00045064506555702623,
  0.00019352939257164992,
  0.00022883554327588604,
  0.00023208760647791605,
  0.00023633567301800654,
  0.000233838807361873,
  0.0004481487869896205,
  0.0003995029715297412,
  0.00028626176602077394,
  0.00023886668549160474,
  0.0002649002242340045,
  0.00022584419653586378,
  0.0002621490548997503,
  0.00021683023184407353,
  0.00023256133834509445,
  0.00023076625460321005,
  0.0002194031359379798,
  0.0002630611259122896,
  0.0002191659076862455,
  0.0002647150810431926,
  0.00021654777592420554,
  0.0002233933822190577,
  0.00021745348292766164,
  0.00022915902618460098,
  0.0002599663518863425,
  0.00020849066556803122,
  0.0002645741494252515,
  0.0002588338430287661,
  0.00021930355747118123,
  0.0002621457964494628,
  0.000263587603539058,
  0.00026660272703072794,
  0.00026311797138607346,
  0.0002569792477856239,
  0.0002609317580930589,
  0.0002571543410553141,
  0.00031983861397158654,
  0.000260604582230587,
  0.0002111788401218059,
  0.0002195236237001804,
  0.00022345151550147904,
  0.00021213695045513528,
  0.00028445030511074147,
  0.00044156466197882324,
  0.00021495287002994292,
  0.0003113451735983325,
  0.0002223990962755846,
  0.00046640873596609614,
  0.00034492665831367805,
  0.0002129047064291913,
  0.0004774986364784927,
  0.00019922765209075456,
  0.0003801971213925817,
  0.00019706422422195624,
  0.00021739887520629299,
  0.0002254368128563394,
  0.00022890672635551062,
  0.00023746036504664089,
  0.0002239168420438998,
  0.00021855722573855516,
  0.00021961183139023846,
  0.0002292178205641455,
  0.00023306822599691333,
  0.000508649734146592,
  0.00047126436026496504,
  0.0003990158186348,
  0.0003732971001208557,
  0.00026637681077717627,
  0.000291793871187144,
  0.000220823767804548,
  0.00020671687932882687,
  0.00021169911368564955,
  0.0002096482208506416,
  0.0002658637687634652,
  0.00022816189957110454,
  0.00026888256744657884,
  0.0002725862000943901,
  0.00026190989508469056,
  0.00022084558449480857,
  0.00021436468204176436,
  0.00021935479894679812,
  0.0002152497872237328,
  0.00026552594149831775,
  0.00022394271969269629,
  0.00025928548889386175,
  0.00026343501446878773,
  0.00025878826482250787,
  0.00026141052735832596,
  0.00026655250397016446,
  0.0002532581836897403,
  0.0002581591696662158,
  0.00026288226072076305,
  0.00024399644490252532,
  0.0002177505357243098,
  0.0002611770424801649,
  0.0002706722433060385,
  0.00027017347046550094,
  0.0002888301264329559,
  0.0002067440997118718,
  0.00021507397864956498,
  0.0002540353572362734,
  0.00031003426052191675,
  0.00020759298990648923,
  0.00020433533837555434,
  0.0002626812314791777,
  0.0003760883246539642,
  0.00039594908373536916,
  0.00026394189791380165,
  0.0002599429329193334,
  0.00026223548850822984,
  0.0002202616804990532,
  0.00026720856954655337,
  0.00022558806473645527,
  0.00026754195219377315,
  0.0002279140144588103,
  0.0002702012658086417,
  0.0002876598522963551,
  0.00045629599510681884,
  0.0002180526592949931,
  0.000494278266592001,
  0.00021568900554247046,
  0.00034752485080938604,
  0.0004777396969447869,
  0.0004276732506370041,
  0.00023512357508298045,
  0.0002401213651033352,
  0.0002250999291167061,
  0.00022496629609024472,
  0.0002424472306596972,
  0.0005006164815605258,
  0.0002915402405118672,
  0.00028353809214042903,
  0.00020596477186217603,
  0.00020306727095735882,
  0.0002712984684219112,
  0.0002333272513908011,
  0.0002327468394395363,
  0.0002711203743390703,
  0.00028287521027530675,
  0.0002109974957283179,
  0.0002630677555173444,
  0.0002570207106682811,
  0.00025189237937245606,
  0.0002546684381094269,
  0.0002621834030437343,
  0.00023044939024059483,
  0.00026474232010891333,
  0.00025994941710612485,
  0.00025829556086381597,
  0.00022224864801651065,
  0.00025992734248218743,
  0.0002550542537179774,
  0.0002519461162846081,
  0.00020490475463315604,
  0.0002683252706776366,
  0.0002300301344805432,
  0.00021503226688409505,
  0.0002531594154981632,
  0.00026393798949683213,
  0.0002570231177427063,
  0.00024148574962083976,
  0.0002626469838650426,
  0.00034920546459987897,
  0.00020663905222685397,
  0.0002159991591292633,
  0.00022012481540914432,
  0.0002651188842045072,
  0.00020822563638727454,
  0.00026804967177525697,
  0.00026399454432327735,
  0.0002646671621451819,
  0.00026214578345514134,
  0.00026893927893002924,
  0.0002738705240637301,
  0.00022324669964026103,
  0.0002268207276337214,
  0.0003215131374442649,
  0.000487274000431087,
  0.0004960400358834294,
  0.0003783437584372733,
  0.0005046164223191353,
  0.00019878660212241668,
  0.00023766961045845858,
  0.00022324696647339743,
  0.00022222654581092153,
  0.0002463587751038274,
  0.0004657617096518808,
  0.00026528125665938143,
  0.00023342553737849245,
  0.00023677200520183343,
  0.00027655442111524693,
  0.00022809151296924194,
  0.00022239502444204308,
  0.00022388926525085336,
  0.00020997334574805791,
  0.00022357849413395502,
  0.00024088748718494577,
  0.00023080793013805005,
  0.00022844007846016193,
  0.0002159025046007237,
  0.0002599418001568818,
  0.00026721687236768934,
  0.0002676177454441882,
  0.00024472914373827937,
  0.00023237756337459182,
  0.0003159784182989991,
  0.00027241482353101656,
  0.0002606433166400337,
  0.0002590057786342388,
  0.0002408856926617152,
  0.00022508001588930239,
  0.0002277919902358187,
  0.0002739613976416477,
  0.00026621239472149604,
  0.0004408099580602196,
  0.00047406193299439747,
  0.00022386286196467706,
  0.00032081074983911597,
  0.00020827948803742955,
  0.00022524885857446575,
  0.00020352606433671075,
  0.00023806828408221015,
  0.00023888429259784686,
  0.00024282805603732002,
  0.0002272444208043253,
  0.00022186142598134052,
  0.0004883008338857881,
  0.00044582335475346914,
  0.0004172790358359442,
  0.0004139392019029926,
  0.00036941030808204385,
  0.00034157182072957424,
  0.0003182525839129253,
  0.0002950274961034636,
  0.000247404748999119,
  0.00023909790923416524,
  0.00028377296289142307,
  0.0002829498414541431,
  0.00023628989970144807,
  0.00023566417399208003,
  0.000232675140665094,
  0.00023674791791591793,
  0.00023835870978717425,
  0.0002598567044523184,
  0.00027178520976574294,
  0.0002460645344136211,
  0.00023491069686021733,
  0.0002632478898038505,
  0.00023482824286134377,
  0.00026680580623606256,
  0.00026914943268281644,
  0.0002695179005861645,
  0.0002688309696596023,
  0.0002094674300381963,
  0.00023319957312151375,
  0.0002161949774292701,
  0.0002765467489868206,
  0.00029559602332069604,
  0.0002125294506239888,
  0.00020473694202489945,
  0.0002203391173418668,
  0.00021452530567285676,
  0.0002480222424862711,
  0.00022569740378481257,
  0.0002655714412653671,
  0.00027683461493838407,
  0.00045234183878837685,
  0.00026634888767409023,
  0.0002737239917868356,
  0.00021524583893139517,
  0.0002310298878510694,
  0.00023632678480649204,
  0.00027728567000943714,
  0.0005084364380235612,
  0.00022696776939451819,
  0.0005138317299936024,
  0.00035107010742574656,
  0.0004927618640460759,
  0.00024143620047046402,
  0.0002321633392245755,
  0.00023715253362134993,
  0.0002427205527490299,
  0.00023270798168935748,
  0.00023697390084726256,
  0.0005081287670418849,
  0.00036003868811170187,
  0.00024307122123464283,
  0.00028170828727087645,
  0.0002014166806111708,
  0.00024044893497534455,
  0.00023665013243786718,
  0.0002877213091652479,
  0.00020530636741476394,
  0.00022833475074274682,
  0.00022820412730303676,
  0.00025197983657948244,
  0.0002383622621261644,
  0.00023907841399116762,
  0.00022650039385599082,
  0.00022301666231708224,
  0.00026258953564613056,
  0.00023181758841432008,
  0.00022945436174410502,
  0.00026035242569087246,
  0.0002709144357882231,
  0.00022688711026436887,
  0.0002709644130444622,
  0.0002902069559832198,
  0.00022126681500118722,
  0.0002298114839851163,
  0.00027199253280399784,
  0.0003355820991478068,
  0.00031697555223394796,
  0.0002801098418226416,
  0.00020804631932476778,
  0.00024606672684593194,
  0.0002126252562569365,
  0.00021174576717978194,
  0.00024992088572266415,
  0.00023700970953014836,
  0.0002683424186256566,
  0.000272799107333353,
  0.00020945962205333658,
  0.00026362895802159236,
  0.0002462928261237317,
  0.0002665110055367025,
  0.00026112535612261595,
  0.0005087272646433233,
  0.00023479719003515804,
  0.00034207416801097215,
  0.0005264341041647743,
  0.00023247496517006655,
  0.00037291692788890237,
  0.00020294935505066697,
  0.0002468923500748036,
  0.0002394568454433546,
  0.00023282988419421518,
  0.00024821524474348344,
  0.0005043497332526035,
  0.000393591238622865,
  0.0002758517689837767,
  0.00025323570433104773,
  0.00020192715147046206,
  0.00024033577990047552,
  0.0002414150882241183,
  0.0002791580181015314,
  0.0002297763438056343,
  0.00023199263922813279,
  0.0002336829483211628,
  0.00023946239726817202,
  0.00024047653322649634,
  0.0002072630642987811,
  0.00021513575415683603,
  0.00020727238093338335,
  0.00022405241904864277,
  0.00026947001801313667,
  0.00030208161008603393,
  0.0002206462278627701,
  0.00022966024822304088,
  0.00020385651939567302,
  0.00027795749014106094,
  0.0002241231927609467,
  0.00040732415416118255,
  0.00023409564695286425,
  0.00024007621315109173,
  0.00028742222607189315,
  0.00028476928299516624,
  0.00026754380673950655,
  0.0002772363862672806,
  0.00024682996378485504,
  0.0002275880190150111,
  0.00029694128711414946,
  0.0003270894539319683,
  0.00024270100023610948,
  0.00040574564346148185,
  0.0004698230638761108,
  0.00023305006309346657,
  0.00022682156712817243,
  0.0005033145828604851,
  0.00033927876268112804,
  0.00030323934449969425,
  0.00029864772011489136,
  0.00023504836014852007,
  0.00021564466708594223,
  0.00029016024971222624,
  0.0002384051854003603,
  0.00023468155252277234,
  ...])
#+end_example

<<b0904c1f-fdfb-4332-8ccb-89973057c352>>
The visualization can be customized as well, e.g. by changing the view
angle and the colormap.

<<7eea08c4-1981-430e-9679-8ac47fb731ff>>
#+begin_src python
nppas.show(quantified_surface, azimuth=-90, cmap='jet')
#+end_src

[[file:563d68bd939ed1e80a9ae4683e524e5493afce50.png]]

<<1fef0d18-f7aa-4dd9-be74-95ad4490ad8f>>
#+begin_src python
nppas.show(quantified_surface, azimuth=-90, cmap='hsv')
#+end_src

[[file:d2f2c35d2bae04abf0b83b449dda8aaefb49c26d.png]]

<<e6ae4134-a40d-4996-bfaa-809d9065f2b4>>
#+begin_src python
#+end_src
