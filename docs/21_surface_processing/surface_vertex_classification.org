<<e970f606-b58f-4560-b555-3383257e70f9>>
* Surface vertex classification
  :PROPERTIES:
  :CUSTOM_ID: surface-vertex-classification
  :END:
In this notebook we demonstrate how to retrieve surface/vertex
measurements to classify vertices on the surface. The used example data
is derived from [[https://zenodo.org/record/7603081#.Y94N4XbMJmN][AV
Luque and JV Veenvliet (2023)]] licensed
[[https://creativecommons.org/licenses/by/4.0/legalcode][CC-BY]]. See
the [[file:creating_surfaces.ipynb][creating_surfaces]] for how to
create the surface from raw imaging data.

See also

- [[https://vedo.embl.es/][vedo library]]
- [[https://vedo.embl.es/autodocs/content/vedo/mesh.html?highlight=curvature#vedo.mesh.Mesh.addCurvatureScalars][vedo
  add curvature documentation]]

You need to additionally install the
[[https://www.napari-hub.org/plugins/napari-accelerated-pixel-and-object-classification][napari-accelerated-pixel-and-object-classification
plugin]], e.g. by calling
=mamba install napari-accelerated-pixel-and-object-classification -c conda-forge=
from the terminal.

<<33f515ba-b872-45db-99f8-ad33193d0658>>
#+begin_src python
import napari_process_points_and_surfaces as nppas

import napari
import apoc
import numpy as np
#+end_src

<<27a7436d-7c6c-4eef-9739-77cf7778c578>>
We will be working with a simple geometry (i.e., an ellipsoid) to
demonstrate the curvature property and the different settings.

<<695a71bb-002f-4695-9e06-fc6cf12f4f79>>
#+begin_src python
surface = nppas.gastruloid()
surface
#+end_src

#+begin_example
The nppas gastruloid example is derived from AV Luque and JV Veenvliet (2023) which is licensed CC-BY (https://creativecommons.org/licenses/by/4.0/legalcode) and can be downloaded from here: https://zenodo.org/record/7603081
#+end_example

#+begin_example
(array([[ 14.174363, 220.40599 , 224.08286 ],
        [ 13.983076, 208.15877 , 220.32153 ],
        [ 14.819012, 219.06023 , 229.4558  ],
        ...,
        [112.18208 , 356.98364 , 430.36832 ],
        [112.3784  , 360.45856 , 421.8425  ],
        [112.865425, 352.2561  , 422.1735  ]], dtype=float32),
 array([[   0,    1,    2],
        [   3,    4,    5],
        [   6,    4,    7],
        ...,
        [3318, 3317, 3316],
        [3316, 3323, 3318],
        [3318, 3323, 3319]], dtype=int64))
#+end_example

<<01709465-0d6a-4b1b-9966-dc47c72f5002>>
** Quantification
   :PROPERTIES:
   :CUSTOM_ID: quantification
   :END:
We can create a table
([[https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html][pandas
Dataframe]]) like this.

<<494e364a-b57a-4da4-b024-fb03b0cbe693>>
#+begin_src python
requested_measurements = [nppas.Quality.AREA, 
                          nppas.Quality.ASPECT_RATIO,
                          nppas.Quality.GAUSS_CURVATURE, 
                          nppas.Quality.MEAN_CURVATURE,
                          nppas.Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL,
                          nppas.Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL,
                         ]

df = nppas.surface_quality_table(surface, requested_measurements)
df
#+end_src

#+begin_example
c:\structure\code\vedo\vedo\pointcloud.py:526: FutureWarning: `rcond` parameter will change to the default of machine precision times ``max(M, N)`` where M and N are the input matrix dimensions.
To use the future default and silence this warning we advise to pass `rcond=None`, to keep using the old, explicitly pass `rcond=-1`.
  C, residue, rank, _ = np.linalg.lstsq(A, f)  # solve AC=f
#+end_example

#+begin_example
      vertex_index  Quality.AREA  Quality.ASPECT_RATIO  \
0                0     29.997389              1.600400   
1                1     46.087046              1.602183   
2                2     35.886338              1.400599   
3                3     22.887296              1.751932   
4                4     29.952347              1.220882   
...            ...           ...                   ...   
3319          3319     25.079661              1.340802   
3320          3320     47.213916              1.254924   
3321          3321     35.964707              1.140267   
3322          3322     45.673529              1.189562   
3323          3323     30.105530              1.151230   

      Quality.GAUSS_CURVATURE  Quality.MEAN_CURVATURE  \
0                    0.030287                0.000490   
1                    0.011136                0.000018   
2                    0.012633                0.000142   
3                    0.036979                0.000548   
4                    0.010277                0.000047   
...                       ...                     ...   
3319                 0.031878                0.000606   
3320                 0.004615                0.000003   
3321                 0.015661                0.000198   
3322                 0.011380                0.000100   
3323                 0.014396                0.000190   

      Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL  \
0                                        0.000257   
1                                        0.000250   
2                                        0.000253   
3                                        0.000379   
4                                        0.000391   
...                                           ...   
3319                                     0.000168   
3320                                     0.000169   
3321                                     0.000163   
3322                                     0.000152   
3323                                     0.000163   

      Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL  
0                                       0.000019  
1                                       0.000019  
2                                       0.000019  
3                                       0.000019  
4                                       0.000019  
...                                          ...  
3319                                    0.000019  
3320                                    0.000019  
3321                                    0.000019  
3322                                    0.000019  
3323                                    0.000019  

[3324 rows x 7 columns]
#+end_example

<<4b116469-1979-4dad-8b49-012fd46c0043>>
To get an overview about measurements, we can summarize them:

<<6b8484d5-6606-4969-8e60-21751049746a>>
#+begin_src python
df.describe().T
#+end_src

#+begin_example
                                              count         mean  \
vertex_index                                 3324.0  1661.500000   
Quality.AREA                                 3324.0    33.753233   
Quality.ASPECT_RATIO                         3324.0     7.126810   
Quality.GAUSS_CURVATURE                      3324.0     0.016958   
Quality.MEAN_CURVATURE                       3324.0     0.000383   
Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL  3324.0     0.000258   
Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL   3324.0     0.000019   

                                                      std       min  \
vertex_index                                 9.597005e+02  0.000000   
Quality.AREA                                 1.079078e+01  5.677486   
Quality.ASPECT_RATIO                         8.990960e+01  1.038034   
Quality.GAUSS_CURVATURE                      3.527488e-02 -1.031106   
Quality.MEAN_CURVATURE                       7.652709e-03 -0.028035   
Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL  6.857515e-05  0.000152   
Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL   3.388642e-21  0.000019   

                                                    25%          50%  \
vertex_index                                 830.750000  1661.500000   
Quality.AREA                                  26.694735    32.956835   
Quality.ASPECT_RATIO                           1.292444     1.437911   
Quality.GAUSS_CURVATURE                        0.005509     0.013645   
Quality.MEAN_CURVATURE                        -0.000135     0.000010   
Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL    0.000214     0.000241   
Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL     0.000019     0.000019   

                                                     75%          max  
vertex_index                                 2492.250000  3323.000000  
Quality.AREA                                   39.255080   125.564101  
Quality.ASPECT_RATIO                            1.648299  3421.965459  
Quality.GAUSS_CURVATURE                         0.024739     0.348243  
Quality.MEAN_CURVATURE                          0.000270     0.426018  
Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL     0.000275     0.000545  
Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL      0.000019     0.000019  
#+end_example

<<acaccf82-910d-4fb5-a208-0e03825fe41f>>
From that table, we can extract a single column as list.

<<d57d4e93-9a21-471e-a18d-1a19fa2cda47>>
#+begin_src python
sp_curvature = list(df['Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL'])
sp_curvature[:5]
#+end_src

#+begin_example
[0.0002572409483117654,
 0.00025042866718866794,
 0.0002531992227477513,
 0.00037887302875519685,
 0.00039058363169657424]
#+end_example

<<5719b476-e642-4e8f-8ae2-03d7a86c34dc>>
** Visualizing measurements
   :PROPERTIES:
   :CUSTOM_ID: visualizing-measurements
   :END:
To visualize the measurements, we need to attach them to the surface:

<<712fb8bb-6e32-47f6-af13-c35140fcf6f0>>
#+begin_src python
quantified_surface = nppas.set_vertex_values(surface, sp_curvature)
#+end_src

<<b0904c1f-fdfb-4332-8ccb-89973057c352>>
The visualization can be customized as well, e.g. by changing the view
angle and the colormap.

<<1abaae19-08ed-4388-8a57-1efeeffaed28>>
#+begin_src python
quantified_surface.azimuth = -135
quantified_surface
#+end_src

#+begin_example
(array([[ 14.174363, 220.40599 , 224.08286 ],
        [ 13.983076, 208.15877 , 220.32153 ],
        [ 14.819012, 219.06023 , 229.4558  ],
        ...,
        [112.18208 , 356.98364 , 430.36832 ],
        [112.3784  , 360.45856 , 421.8425  ],
        [112.865425, 352.2561  , 422.1735  ]], dtype=float32),
 array([[   0,    1,    2],
        [   3,    4,    5],
        [   6,    4,    7],
        ...,
        [3318, 3317, 3316],
        [3316, 3323, 3318],
        [3318, 3323, 3319]], dtype=int64),
 [0.0002572409483117654,
  0.00025042866718866794,
  0.0002531992227477513,
  0.00037887302875519685,
  0.00039058363169657424,
  0.0003600190783964104,
  0.0003812024248736095,
  0.0004032214052519288,
  0.0002661565851518192,
  0.0002720534146162575,
  0.0002614593000182443,
  0.0002535430671034702,
  0.0002444765153185341,
  0.000257360827669421,
  0.00025511530875216005,
  0.00042729231737963306,
  0.00040987383076612847,
  0.0004150967696368238,
  0.0003926723959885801,
  0.0003564980315785759,
  0.0003623340825496488,
  0.00033555981114871653,
  0.00033173650865084286,
  0.0002921858941142099,
  0.0002892736949807465,
  0.0002721312389510652,
  0.0002739698612751383,
  0.00025648821536703267,
  0.0002612249776248378,
  0.0002478275507613372,
  0.00026498619789606747,
  0.00026065427051607403,
  0.0002524483195951812,
  0.00019891821191909436,
  0.00020176568265474089,
  0.00020818335784812488,
  0.0001850191151668224,
  0.0002076759196735631,
  0.0001690413263473044,
  0.00016712950748005062,
  0.0001684276906393751,
  0.00017519826069848274,
  0.00017313698174847573,
  0.00016952165218300845,
  0.00017064989767587353,
  0.00018770826806459447,
  0.0001852143259732519,
  0.0001923523927073288,
  0.00019944376481798653,
  0.00019322147485570867,
  0.0004272880169744272,
  0.00036595567871689725,
  0.0003132085794564319,
  0.00034012046388165316,
  0.00030500059081084826,
  0.00031644591183555357,
  0.0003164924482079102,
  0.0002717489166254353,
  0.0002966246372772681,
  0.0002696932664949742,
  0.0002444676981293004,
  0.00026216161449327605,
  0.00026243819275078927,
  0.00025959623242481785,
  0.0002536757731849083,
  0.00021426161322416978,
  0.00021748430529425168,
  0.0002040980568482802,
  0.00021400355001653394,
  0.00019214256535299328,
  0.00020509264508201098,
  0.00018253943460016533,
  0.00017454588186636665,
  0.0001713500138058328,
  0.00017694103381585434,
  0.00017555980167772148,
  0.00017827197531162153,
  0.00017038514614467286,
  0.00016902581961629817,
  0.00017623218514931563,
  0.0001768753462650038,
  0.00017058922428553688,
  0.00017349616645110643,
  0.00017501709326249017,
  0.0001711842426333082,
  0.0001693081006526344,
  0.0001707192686465572,
  0.00017425499642092498,
  0.00017100157018340253,
  0.00017163491312213996,
  0.00017902069002878008,
  0.00019059227938701603,
  0.0001923885437297693,
  0.00018288453427589888,
  0.00018364720765073748,
  0.0001868497096903202,
  0.0001896479190321488,
  0.00020123964674876847,
  0.00019707817843142572,
  0.00020782125792412858,
  0.00021144493925669554,
  0.00020766153444654346,
  0.00043871884645211147,
  0.0004009767688542877,
  0.00040662381715911566,
  0.0004314457126305084,
  0.0003590238656272754,
  0.0003306031915479628,
  0.0003245627731504485,
  0.0003002202891710231,
  0.00029067551937629604,
  0.00032003665234913705,
  0.000262084120447589,
  0.0002616737912426526,
  0.00026765465224470907,
  0.0002642306988428909,
  0.0002521125145869295,
  0.0002562409438027258,
  0.00026524212313002913,
  0.00025775642493665383,
  0.0002527826022894682,
  0.0002511083640454574,
  0.00025872755582161615,
  0.0002525425677182156,
  0.0002202958097073085,
  0.00022296004718168385,
  0.00022531950092256778,
  0.0001959227614219583,
  0.00018939125953744125,
  0.00019768087544193047,
  0.00019178026167455538,
  0.00018047806258040714,
  0.00019168217876493543,
  0.0001854649539868315,
  0.00017275093398090628,
  0.0001739426121088212,
  0.0001721593673798292,
  0.00016934862505775538,
  0.0001703908558524394,
  0.00017916195998997586,
  0.0001740827321789608,
  0.00017847634207757889,
  0.00019923057882689863,
  0.00020583932838629006,
  0.00020088081237020728,
  0.0001770723133434025,
  0.00018225261479453097,
  0.00018366698090515655,
  0.0001839510525160222,
  0.00019009394550183789,
  0.00019110735418332417,
  0.0001961086462098786,
  0.00020264192042413322,
  0.00019081470141223375,
  0.0001911449718892122,
  0.00019340424649958823,
  0.00019099880937553554,
  0.00019304701721413253,
  0.0002088798367192103,
  0.00021266639930419174,
  0.00020125843236592995,
  0.00021984663440018348,
  0.0002116529027549625,
  0.00021973863485490733,
  0.00046776821535878297,
  0.0004485669192628907,
  0.00040752902243874363,
  0.0003390299981766002,
  0.00028404249833768777,
  0.00027518484063141353,
  0.00028966281369440146,
  0.0002456891891690936,
  0.0002681408431344346,
  0.00025067017745307603,
  0.0002512694996493835,
  0.0002701620100982459,
  0.0002655611133476862,
  0.00024298182507705762,
  0.00022854620363627426,
  0.00022030624310974731,
  0.00021193312066660378,
  0.00020914621947957078,
  0.00018000802256514222,
  0.00019859616560046942,
  0.000192520192177157,
  0.00018368592865268782,
  0.00020316205136171884,
  0.00017549459816169303,
  0.00020597873799317183,
  0.00020132725385164606,
  0.00018959219087017666,
  0.00016916695439046545,
  0.0001713402548120956,
  0.00020547508742545007,
  0.00020901978265262753,
  0.00018903389216157144,
  0.00018145574637417995,
  0.00018998581222857587,
  0.00018162241388167526,
  0.000203386400246518,
  0.000208874310192469,
  0.00018218324259734555,
  0.000196258915795681,
  0.00018979140090049282,
  0.00019854015987737548,
  0.0001989071980163347,
  0.00019626389248716082,
  0.00019473928896237075,
  0.00021035423319750856,
  0.00021647585725383098,
  0.00020151710974876996,
  0.0002096047934157277,
  0.0004680865798606284,
  0.00043643942220402874,
  0.00045955931586469655,
  0.00032574646654771254,
  0.00032070422568487535,
  0.0002723585552231615,
  0.0002686969019314391,
  0.00026541602221863045,
  0.00024405238976237784,
  0.0002690032181377179,
  0.00025055720911743414,
  0.0002461817363861581,
  0.00024673033956802606,
  0.0002489148609306626,
  0.00024092942088554798,
  0.00026300275479939305,
  0.0002575577361659125,
  0.0002263660404615987,
  0.00022854644883068946,
  0.0001948637801409936,
  0.00022286741331099176,
  0.00021881525775487378,
  0.00020730612312128005,
  0.00019922317142017764,
  0.0002106423209152624,
  0.0001937771165249365,
  0.00020643066433257364,
  0.0002008719668712928,
  0.00019237338894491558,
  0.00018792880860031035,
  0.00018771574080785416,
  0.00019584417460056017,
  0.0001991795753341003,
  0.00020813812911828772,
  0.00020708107200883367,
  0.00020031426605868295,
  0.0002055777715214283,
  0.0001948890586612668,
  0.00021939174663669246,
  0.0002117143459356029,
  0.00022370677438643513,
  0.00021779231311392876,
  0.0002309675520474359,
  0.0002283503484300704,
  0.000492589026743866,
  0.0004568308976832353,
  0.00039599550266274986,
  0.00035391816464968386,
  0.00034710735994420577,
  0.000310571409190902,
  0.00026946852780939605,
  0.00024433451245367625,
  0.0002707673049030154,
  0.0002404592644654933,
  0.0002327800877342916,
  0.00024398479677139936,
  0.0002607439119219324,
  0.00023300398987472856,
  0.0002555874148730387,
  0.0002231415223809325,
  0.0002322138108309095,
  0.00025102431055217846,
  0.00022824839267056603,
  0.00022482730093632296,
  0.00020672239491871847,
  0.00018328193237959598,
  0.00019157238215190812,
  0.00019908276288780417,
  0.00019506833313707517,
  0.00018733947917816692,
  0.00021202865270770593,
  0.00021524312286907288,
  0.00018038291445962088,
  0.00017676284863639888,
  0.00021132059926795585,
  0.0002055417880661882,
  0.00019734251305815757,
  0.0001743536798209669,
  0.00020939486181488018,
  0.0002114207227380847,
  0.0002146481175787506,
  0.0002119685161447376,
  0.0001837017879044986,
  0.00018743850672576668,
  0.0002074918058438426,
  0.0001950841549790114,
  0.00020904511709764784,
  0.0001943279803240434,
  0.00021580077995388052,
  0.0002080730561690934,
  0.0002076710010649108,
  0.00021671016132767618,
  0.00019709817011781162,
  0.0002027607872706698,
  0.00020024927014514857,
  0.00020672060086834835,
  0.0002309500910051472,
  0.00048482965784988507,
  0.0004674311979821743,
  0.00040372562853103523,
  0.0003724680808212764,
  0.00032247611231371414,
  0.0002955691169265773,
  0.00028783765787860797,
  0.00031979281662994385,
  0.0002912175725564022,
  0.00024424046832551065,
  0.0002708491863007032,
  0.0002775801317309271,
  0.00023299845725594052,
  0.00022901481747290562,
  0.0002197787166332614,
  0.0001985638463038121,
  0.0002101291671081594,
  0.00021757838052402338,
  0.00021416364351621876,
  0.00021178154667650007,
  0.0001769012284444127,
  0.0002071754107415163,
  0.0002114614157171121,
  0.00021511856012035682,
  0.0002037515161060317,
  0.00019690474562870407,
  0.00019918128340407792,
  0.00019244986007417432,
  0.00018446177443640958,
  0.00020164928467767836,
  0.00018894863480386912,
  0.0002184789675083205,
  0.00021246014973784166,
  0.00021484351284961273,
  0.00023050084401594407,
  0.00047855134511230355,
  0.0004437276418315804,
  0.00040003002926159434,
  0.0003680682219857416,
  0.00025404682797200136,
  0.0002477618977419019,
  0.0002445566764788956,
  0.0002461953919776252,
  0.0002735197541529191,
  0.0002329358656724729,
  0.00026711627709193937,
  0.00027042079134058725,
  0.00024580366261784607,
  0.00022828298321268809,
  0.000225413698654941,
  0.0002002083465991755,
  0.0002213931021629025,
  0.00020326158290221284,
  0.0002048156937653914,
  0.00021423711593993866,
  0.00021846363333007516,
  0.00020761958885269263,
  0.00021409717873805092,
  0.00021783558292171872,
  0.00021631560841671555,
  0.0002057118425664852,
  0.0002186834640952807,
  0.00020087987183766323,
  0.000203864689368542,
  0.00020296022733738852,
  0.00018630535263512745,
  0.0001909324110043715,
  0.00019354134821432866,
  0.0002068310689818182,
  0.00021617548276783434,
  0.00020269858175096876,
  0.0002211590976297711,
  0.0002261887075221709,
  0.00020290715637311265,
  0.00020600602635844045,
  0.00021167386306702402,
  0.00023528694630057438,
  0.00047104248881903144,
  0.0004298671806014713,
  0.00034848833666032287,
  0.0002717678425272209,
  0.000283739692619466,
  0.00026849644337294704,
  0.00024069440776475586,
  0.00022792909458651246,
  0.0002746198992432774,
  0.00026344743370852974,
  0.00023846789459395037,
  0.0002341241780359544,
  0.00022796576905988043,
  0.00023408361358263522,
  0.0002577927093940078,
  0.00023234344530115872,
  0.00025673578628640763,
  0.00021888667455907077,
  0.00021326189610261718,
  0.00022372972128355465,
  0.00020302122915970118,
  0.00020127033279710373,
  0.00021927333816150411,
  0.00021292867755350273,
  0.0002169841658335495,
  0.00020855907600225642,
  0.00021362653859921958,
  0.00021671155039467774,
  0.00021414073658895493,
  0.00021448110007243743,
  0.00020619395397284332,
  0.00035407168317798024,
  0.0003737573408284832,
  0.0003815991057690912,
  0.0002194328601539502,
  0.00021126113177152893,
  0.0002054056363368125,
  0.0002114054223032478,
  0.00019662963218791988,
  0.00022620524968392446,
  0.00022716251251196835,
  0.00020701803644182864,
  0.00023832414334023775,
  0.00023570374876096063,
  0.0004936242307039256,
  0.0005008874445865387,
  0.0004987881968963418,
  0.000454423571913552,
  0.00043299916515746463,
  0.0004039409381393438,
  0.00028993874654093687,
  0.0003056676659953289,
  0.0002797703967201703,
  0.00027889568315659193,
  0.00027109142825509485,
  0.00026815857919730156,
  0.00023646989900288578,
  0.00023216303135617974,
  0.00020806156322725276,
  0.00020715839311273563,
  0.00021390372536674574,
  0.00022771576993049127,
  0.00023849221376701294,
  0.00025156311975653396,
  0.00020831596500247416,
  0.00021215041271337038,
  0.0002204255633521189,
  0.0002134169519207485,
  0.00021155013843693308,
  0.00035107824600993004,
  0.00038515106934470535,
  0.0003227215258586011,
  0.0003994267414881104,
  0.00040587644016793487,
  0.00020928466654789688,
  0.00033288041781442084,
  0.0003680703947488343,
  0.0003958342313438043,
  0.00021840370622569212,
  0.00022231991203276898,
  0.00020775347197660092,
  0.00019182181677096166,
  0.00022019346880026053,
  0.00022323515224011503,
  0.00021570608190538305,
  0.00022518737441733534,
  0.00021050182539955546,
  0.00022017624049791625,
  0.00021796752033351687,
  0.00024101367195080846,
  0.00023832527363578488,
  0.000503632251065675,
  0.00047727781379027233,
  0.0004609891814596501,
  0.0003856725323676667,
  0.0002596769888765666,
  0.00023180513597945344,
  0.0002248141976582217,
  0.00022220998178813767,
  0.00026377909438432046,
  0.00021410161647344094,
  0.00022968652284117646,
  0.00024077399771173672,
  0.00022078960215869554,
  0.00022384823723361742,
  0.00021593587589431733,
  0.0002117721358041025,
  0.00020749997948282933,
  0.0002975105921703266,
  0.0003269871316623249,
  0.0002994133405402456,
  0.0003139939216724202,
  0.00031737583633959426,
  0.0003294658150922287,
  0.0003543595463959959,
  0.00041393498911755546,
  0.00039878158280729354,
  0.00021293094512325628,
  0.0003774494782826511,
  0.00019702387347654893,
  0.00021489198322365317,
  0.00020101950058212646,
  0.00020386292342649008,
  0.00021779241288615,
  0.0002199491124709291,
  0.00023484160842145502,
  0.0002103664684613885,
  0.00021416229496911071,
  0.00022368961335334962,
  0.00022776964843339138,
  0.0005061701113219461,
  0.0004845695064637122,
  0.0003908862091443241,
  0.000356775318810615,
  0.0003334777403748549,
  0.0003341874365765048,
  0.000304998689892581,
  0.0002449441410515119,
  0.0002423099092163534,
  0.0002761673018530653,
  0.00028079664573006115,
  0.00021650153247470207,
  0.0002829571811634665,
  0.00022081208774272774,
  0.00023080248021315494,
  0.00023109588089876708,
  0.00021875886541004345,
  0.00023045213339867247,
  0.00021498388806971076,
  0.00021027289033857908,
  0.00025901919177296343,
  0.00024078671221461857,
  0.00025157071006659814,
  0.00024489469365698526,
  0.00021782058192957907,
  0.00021377891461567792,
  0.0002620664344594354,
  0.00026036111177190984,
  0.00026209615764793867,
  0.00020900989756630998,
  0.00027239311039243625,
  0.0002796771409639387,
  0.00029297036127149165,
  0.00035572319733929606,
  0.00021346342471381482,
  0.0004225066886135695,
  0.00022206350259231254,
  0.0004204287373611115,
  0.00021023906946195464,
  0.00021032580619965356,
  0.00030614781441345854,
  0.00027437550058159325,
  0.00043052067218247455,
  0.00022158047232672922,
  0.00021820411995549007,
  0.0003416833906779358,
  0.0004269416487810156,
  0.00020594391861474118,
  0.00034620060488255524,
  0.00037672278469688274,
  0.00041465356175870684,
  0.00023284995486699226,
  0.0002332323726910148,
  0.00021972163432454594,
  0.00021577161578990303,
  0.0002152758290198492,
  0.00023894466813732606,
  0.00021950324546062837,
  0.00023619770204550802,
  0.00042466269184215975,
  0.00037488607391809577,
  0.0003003789812309556,
  0.00024609257248382993,
  0.0002869648741774345,
  0.00021640823659621562,
  0.00021646218840134777,
  0.00021436147589927606,
  0.00022104774140382257,
  0.00021791879950005285,
  0.00026122295913236167,
  0.00021505252702217243,
  0.0002266755144537834,
  0.00021657792379842778,
  0.0002295896343204536,
  0.00024274865402102675,
  0.00021989783934526868,
  0.00022083733746111072,
  0.0002636557292629127,
  0.00026281884993372627,
  0.0002646336807886264,
  0.0002555415368646273,
  0.00025524114389854235,
  0.0002088282122686083,
  0.0002577255122026323,
  0.0002156566660238897,
  0.00027697483250299225,
  0.0003044963075247014,
  0.0003326266413538081,
  0.0002191205954385558,
  0.0002120177269611744,
  0.00025596167264917266,
  0.00042082863657708856,
  0.00040470162639091883,
  0.0002083985236868652,
  0.0004446488435389724,
  0.00045458411280314417,
  0.00020964787868269492,
  0.0004506449763059401,
  0.00019352940245649406,
  0.00022883553757297963,
  0.00023208763747875253,
  0.00023633568411705723,
  0.0002338388890831334,
  0.00044814878942722627,
  0.0003995029761896205,
  0.0002862617732293846,
  0.00023886667487118594,
  0.0002649002271144391,
  0.00022584415963479695,
  0.0002621490476188427,
  0.0002168301954488264,
  0.0002325613170190171,
  0.00023076621561532852,
  0.0002194030958930049,
  0.00026306111814992537,
  0.0002191658684518849,
  0.00026471507318123993,
  0.00021654778211774024,
  0.00022339338487157881,
  0.00021745345764173402,
  0.00022915902599551606,
  0.000259966324257117,
  0.00020849065821372393,
  0.00026457406252075204,
  0.00025883381979967664,
  0.00021930354386382153,
  0.00026214571657280845,
  0.0002635875352115152,
  0.000266602733341571,
  0.0002631179700061342,
  0.00025697924383927875,
  0.0002609317118873354,
  0.0002571542876495896,
  0.00031983848438777655,
  0.00026060453209644113,
  0.00021117882074105326,
  0.0002195236282388052,
  0.00022345153450550913,
  0.00021213692909023712,
  0.00028445021728066785,
  0.0004415644964506656,
  0.0002149528469996647,
  0.0003113450567907527,
  0.00022239911997871137,
  0.00046640855045513815,
  0.0003449265196353005,
  0.0002129046799596582,
  0.0004774985075816509,
  0.00019922766001181677,
  0.00038019706587825953,
  0.00019706423376235992,
  0.00021739886226839337,
  0.00022543681040504076,
  0.0002289067431934797,
  0.00023746041369981143,
  0.00022391688321705226,
  0.00021855726826674695,
  0.00021961187630663146,
  0.0002292178442094261,
  0.00023306827187975434,
  0.000508649719997113,
  0.00047126435369137463,
  0.0003990158219635763,
  0.0003732971065434158,
  0.0002663768140644715,
  0.0002917938749731196,
  0.00022082375526616513,
  0.00020671686633420892,
  0.00021169910677421684,
  0.00020964821784120866,
  0.0002658637651858694,
  0.00022816184665813393,
  0.0002688825112392039,
  0.00027258616417736415,
  0.0002619098501676952,
  0.0002208455421548181,
  0.00021436467697858732,
  0.00021935476852992747,
  0.00021524975899276275,
  0.0002655258715398927,
  0.0002239427068495667,
  0.0002592854692394666,
  0.00026343497965045646,
  0.0002587882551545605,
  0.0002614104985821019,
  0.00026655242313843144,
  0.0002532581769726192,
  0.0002581591356594534,
  0.0002628822068248438,
  0.00024399644033476744,
  0.00021775052765661885,
  0.0002611769935631919,
  0.0002706721661976996,
  0.0002701733870593791,
  0.00028883001968482876,
  0.00020674409359196312,
  0.00021507395487174318,
  0.00025403535696610766,
  0.00031003415040967955,
  0.0002075929945693273,
  0.00020433533896604204,
  0.00026268118445649057,
  0.0003760881576705622,
  0.00039594892604301367,
  0.00026394186270435024,
  0.0002599428857549487,
  0.0002622354493959575,
  0.0002202616882933266,
  0.0002672085094468217,
  0.00022558808477495795,
  0.00026754188719080513,
  0.00022791404327283845,
  0.0002702011989892223,
  0.0002876597656714381,
  0.00045629578690428653,
  0.0002180526384202751,
  0.0004942780933326304,
  0.0002156890260159447,
  0.000347524741178945,
  0.0004777395915061916,
  0.00042767320410709326,
  0.000235123613229884,
  0.00024012143116863168,
  0.00022509998799347822,
  0.0002249663139653633,
  0.00024244727723125896,
  0.0005006164747358289,
  0.000291540255574728,
  0.0002835381001332486,
  0.00020596475406335204,
  0.0002030672673974663,
  0.0002712984686273238,
  0.00023332721131515553,
  0.00023274680300822825,
  0.0002711203342463831,
  0.00028287515382957964,
  0.00021099749079053675,
  0.0002630677304859412,
  0.00025702069562911237,
  0.00025189233903925607,
  0.00025466839413360053,
  0.0002621834022583043,
  0.00023044937351453956,
  0.0002647422886029966,
  0.00025994940230857636,
  0.00025829555174782876,
  0.00022224864666715472,
  0.000259927308805903,
  0.0002550542576318646,
  0.000251946115132901,
  0.00020490475091587847,
  0.0002683252707557709,
  0.00023003012842916101,
  0.00021503225172119555,
  0.00025315941054004573,
  0.00026393798434733986,
  0.0002570231130692133,
  0.00024148574544606072,
  0.000262646994855401,
  0.0003492053224796177,
  0.00020663905441718384,
  0.0002159991637470008,
  0.0002201248248740928,
  0.00026511887171640767,
  0.00020822560919777386,
  0.00026804969713368825,
  0.00026399449797201847,
  0.0002646671684778046,
  0.00026214573644515814,
  0.0002689392356122324,
  0.000273870470383823,
  0.00022324672993737782,
  0.00022682075558001254,
  0.0003215130305512898,
  0.00048727376098981894,
  0.0004960399244121474,
  0.0003783436875486053,
  0.000504616366492491,
  0.00019878660874435124,
  0.0002376696081459788,
  0.00022324699358711685,
  0.0002222265671761483,
  0.0002463588565043276,
  0.0004657617258324693,
  0.00026528125651264324,
  0.00023342548891771601,
  0.0002367719518255069,
  0.00027655438314973105,
  0.00022809144756426964,
  0.000222394982101282,
  0.00022388921417988909,
  0.00020997333990318914,
  0.00022357844527001004,
  0.0002408874650351089,
  0.0002308079283991427,
  0.0002284400862511491,
  0.00021590248096791385,
  0.0002599417639018193,
  0.0002672168605896226,
  0.0002676176824429637,
  0.0002447291527572375,
  0.0002323775543040199,
  0.0003159782999346049,
  0.00027241482324793495,
  0.00026064329688998023,
  0.00025900577955227736,
  0.00024088569269097327,
  0.0002250800282669136,
  0.00022779200910349887,
  0.000273961393370479,
  0.0002662124136876157,
  0.0004408096846484007,
  0.0004740616833803021,
  0.00022386289638435486,
  0.00032081063998360847,
  0.00020827950487268824,
  0.0002252488630775668,
  0.00020352607603009256,
  0.00023806828916009455,
  0.00023888432934061405,
  0.0002428281024610417,
  0.0002272444769247129,
  0.00022186144703725767,
  0.0004883008272951805,
  0.0004458233633150582,
  0.00041727902846750846,
  0.0004139392180181282,
  0.0003694103107691933,
  0.00034157182244810044,
  0.0003182525926801226,
  0.0002950275030704981,
  0.0002474047475390925,
  0.0002390979022181551,
  0.00028377296930134086,
  0.00028294985008725374,
  0.00023628985811015575,
  0.0002356641215283511,
  0.0002326750845419482,
  0.0002367478405125458,
  0.0002383586631478549,
  0.0002598566676624926,
  0.00027178517479336476,
  0.0002460644952866969,
  0.0002349106806640991,
  0.0002632478826622236,
  0.00023482824516374195,
  0.00026680576687273367,
  0.0002691494299865416,
  0.0002695178138358613,
  0.00026883088290871295,
  0.00020946741436080266,
  0.00023319955368886937,
  0.0002161949835651715,
  0.0002765466505851127,
  0.0002955959290540698,
  0.00021252944216053598,
  0.0002047369360410398,
  0.00022033912715498726,
  0.00021452530827499787,
  0.0002480222589583474,
  0.0002256974146277446,
  0.00026557142595970635,
  0.00027683462083822225,
  0.0004523415520531939,
  0.0002663488674411498,
  0.00027372394306384606,
  0.00021524582539918314,
  0.00023102990660262443,
  0.0002363268051694358,
  0.0002772856157924219,
  0.0005084361201886089,
  0.00022696778226588365,
  0.0005138314579852047,
  0.0003510699776119061,
  0.0004927618067968295,
  0.00024143623705345752,
  0.00023216337022464553,
  0.00023715256153277644,
  0.00024272062414070828,
  0.00023270800226260184,
  0.00023697396448789897,
  0.0005081287539180631,
  0.00036003869636793144,
  0.00024307121438333463,
  0.0002817082861143026,
  0.00020141667269218372,
  0.00024044888406540526,
  0.00023665008708510535,
  0.0002877212511659484,
  0.0002053063575116582,
  0.00022833469909645416,
  0.00022820405720643411,
  0.0002519797925974836,
  0.00023836226129676853,
  0.00023907839057318565,
  0.00022650034307087572,
  0.0002230166256153578,
  0.0002625895178860117,
  0.00023181759336324305,
  0.00022945434841334768,
  0.0002603523907249894,
  0.000270914350676769,
  0.00022688709485139448,
  0.0002709643453745897,
  0.00029020683158910513,
  0.00022126681132111358,
  0.00022981146462894476,
  0.00027199252715273605,
  0.0003355819751185025,
  0.0003169754390676239,
  0.0002801098412864023,
  0.00020804632115663412,
  0.00024606673839197465,
  0.00021262524502354356,
  0.00021174575635848718,
  0.0002499208990677232,
  0.00023700972155000827,
  0.0002683424263201628,
  0.0002727990736977454,
  0.0002094595968067332,
  0.00026362896354713733,
  0.0002462928469835977,
  0.00026651101870548636,
  0.0002611253737368239,
  0.0005087269945213708,
  0.0002347972039463062,
  0.0003420740561268232,
  0.0005264339200326826,
  0.0002324749668782289,
  0.00037291684693152187,
  0.00020294936846119638,
  0.00024689242930706886,
  0.0002394569118320524,
  0.00023282995789140274,
  0.0002482152803775683,
  0.0005043497263027117,
  0.0003935912452624282,
  0.00027585176843783433,
  0.0002532357033430806,
  0.0002019271431013449,
  0.00024033573637324978,
  0.0002414150524513727,
  0.00027915799423727176,
  0.00022977628067875626,
  0.00023199258216109628,
  0.0002336828688916724,
  0.00023946239881152113,
  0.00024047649501667342,
  0.0002072630588775769,
  0.00021513575429566025,
  0.00020727236210952164,
  0.00022405243465644634,
  0.0002694700043560791,
  0.0003020815072987705,
  0.00022064622658779498,
  0.00022966024326510003,
  0.0002038565243139163,
  0.00027795748484305525,
  0.00022412319688771594,
  0.0004073239671934306,
  0.00023409566123452403,
  0.0002400762262157307,
  0.00028742222499159975,
  0.0002847693007693012,
  0.0002675438262647958,
  0.00027723640650957447,
  0.00024682998800776144,
  0.00022758804665820215,
  0.0002969411902937143,
  0.0003270893316287644,
  0.00024270099939010007,
  0.00040574559321513885,
  0.0004698230079745325,
  0.0002330501302540789,
  0.00022682160917069307,
  0.0005033145742390559,
  0.0003392787648707439,
  0.00030323935259706,
  0.0002986477367417678,
  0.00023504834887799641,
  0.0002156446507287354,
  0.0002901602586047627,
  0.0002384051254591677,
  0.00023468149874405063,
  ...])
#+end_example

<<02ed9688-abab-4cb1-b25f-81c27cb2b34f>>
#+begin_src python
quantified_surface.cmap = 'jet'
quantified_surface
#+end_src

#+begin_example
(array([[ 14.174363, 220.40599 , 224.08286 ],
        [ 13.983076, 208.15877 , 220.32153 ],
        [ 14.819012, 219.06023 , 229.4558  ],
        ...,
        [112.18208 , 356.98364 , 430.36832 ],
        [112.3784  , 360.45856 , 421.8425  ],
        [112.865425, 352.2561  , 422.1735  ]], dtype=float32),
 array([[   0,    1,    2],
        [   3,    4,    5],
        [   6,    4,    7],
        ...,
        [3318, 3317, 3316],
        [3316, 3323, 3318],
        [3318, 3323, 3319]], dtype=int64),
 [0.0002572409483117654,
  0.00025042866718866794,
  0.0002531992227477513,
  0.00037887302875519685,
  0.00039058363169657424,
  0.0003600190783964104,
  0.0003812024248736095,
  0.0004032214052519288,
  0.0002661565851518192,
  0.0002720534146162575,
  0.0002614593000182443,
  0.0002535430671034702,
  0.0002444765153185341,
  0.000257360827669421,
  0.00025511530875216005,
  0.00042729231737963306,
  0.00040987383076612847,
  0.0004150967696368238,
  0.0003926723959885801,
  0.0003564980315785759,
  0.0003623340825496488,
  0.00033555981114871653,
  0.00033173650865084286,
  0.0002921858941142099,
  0.0002892736949807465,
  0.0002721312389510652,
  0.0002739698612751383,
  0.00025648821536703267,
  0.0002612249776248378,
  0.0002478275507613372,
  0.00026498619789606747,
  0.00026065427051607403,
  0.0002524483195951812,
  0.00019891821191909436,
  0.00020176568265474089,
  0.00020818335784812488,
  0.0001850191151668224,
  0.0002076759196735631,
  0.0001690413263473044,
  0.00016712950748005062,
  0.0001684276906393751,
  0.00017519826069848274,
  0.00017313698174847573,
  0.00016952165218300845,
  0.00017064989767587353,
  0.00018770826806459447,
  0.0001852143259732519,
  0.0001923523927073288,
  0.00019944376481798653,
  0.00019322147485570867,
  0.0004272880169744272,
  0.00036595567871689725,
  0.0003132085794564319,
  0.00034012046388165316,
  0.00030500059081084826,
  0.00031644591183555357,
  0.0003164924482079102,
  0.0002717489166254353,
  0.0002966246372772681,
  0.0002696932664949742,
  0.0002444676981293004,
  0.00026216161449327605,
  0.00026243819275078927,
  0.00025959623242481785,
  0.0002536757731849083,
  0.00021426161322416978,
  0.00021748430529425168,
  0.0002040980568482802,
  0.00021400355001653394,
  0.00019214256535299328,
  0.00020509264508201098,
  0.00018253943460016533,
  0.00017454588186636665,
  0.0001713500138058328,
  0.00017694103381585434,
  0.00017555980167772148,
  0.00017827197531162153,
  0.00017038514614467286,
  0.00016902581961629817,
  0.00017623218514931563,
  0.0001768753462650038,
  0.00017058922428553688,
  0.00017349616645110643,
  0.00017501709326249017,
  0.0001711842426333082,
  0.0001693081006526344,
  0.0001707192686465572,
  0.00017425499642092498,
  0.00017100157018340253,
  0.00017163491312213996,
  0.00017902069002878008,
  0.00019059227938701603,
  0.0001923885437297693,
  0.00018288453427589888,
  0.00018364720765073748,
  0.0001868497096903202,
  0.0001896479190321488,
  0.00020123964674876847,
  0.00019707817843142572,
  0.00020782125792412858,
  0.00021144493925669554,
  0.00020766153444654346,
  0.00043871884645211147,
  0.0004009767688542877,
  0.00040662381715911566,
  0.0004314457126305084,
  0.0003590238656272754,
  0.0003306031915479628,
  0.0003245627731504485,
  0.0003002202891710231,
  0.00029067551937629604,
  0.00032003665234913705,
  0.000262084120447589,
  0.0002616737912426526,
  0.00026765465224470907,
  0.0002642306988428909,
  0.0002521125145869295,
  0.0002562409438027258,
  0.00026524212313002913,
  0.00025775642493665383,
  0.0002527826022894682,
  0.0002511083640454574,
  0.00025872755582161615,
  0.0002525425677182156,
  0.0002202958097073085,
  0.00022296004718168385,
  0.00022531950092256778,
  0.0001959227614219583,
  0.00018939125953744125,
  0.00019768087544193047,
  0.00019178026167455538,
  0.00018047806258040714,
  0.00019168217876493543,
  0.0001854649539868315,
  0.00017275093398090628,
  0.0001739426121088212,
  0.0001721593673798292,
  0.00016934862505775538,
  0.0001703908558524394,
  0.00017916195998997586,
  0.0001740827321789608,
  0.00017847634207757889,
  0.00019923057882689863,
  0.00020583932838629006,
  0.00020088081237020728,
  0.0001770723133434025,
  0.00018225261479453097,
  0.00018366698090515655,
  0.0001839510525160222,
  0.00019009394550183789,
  0.00019110735418332417,
  0.0001961086462098786,
  0.00020264192042413322,
  0.00019081470141223375,
  0.0001911449718892122,
  0.00019340424649958823,
  0.00019099880937553554,
  0.00019304701721413253,
  0.0002088798367192103,
  0.00021266639930419174,
  0.00020125843236592995,
  0.00021984663440018348,
  0.0002116529027549625,
  0.00021973863485490733,
  0.00046776821535878297,
  0.0004485669192628907,
  0.00040752902243874363,
  0.0003390299981766002,
  0.00028404249833768777,
  0.00027518484063141353,
  0.00028966281369440146,
  0.0002456891891690936,
  0.0002681408431344346,
  0.00025067017745307603,
  0.0002512694996493835,
  0.0002701620100982459,
  0.0002655611133476862,
  0.00024298182507705762,
  0.00022854620363627426,
  0.00022030624310974731,
  0.00021193312066660378,
  0.00020914621947957078,
  0.00018000802256514222,
  0.00019859616560046942,
  0.000192520192177157,
  0.00018368592865268782,
  0.00020316205136171884,
  0.00017549459816169303,
  0.00020597873799317183,
  0.00020132725385164606,
  0.00018959219087017666,
  0.00016916695439046545,
  0.0001713402548120956,
  0.00020547508742545007,
  0.00020901978265262753,
  0.00018903389216157144,
  0.00018145574637417995,
  0.00018998581222857587,
  0.00018162241388167526,
  0.000203386400246518,
  0.000208874310192469,
  0.00018218324259734555,
  0.000196258915795681,
  0.00018979140090049282,
  0.00019854015987737548,
  0.0001989071980163347,
  0.00019626389248716082,
  0.00019473928896237075,
  0.00021035423319750856,
  0.00021647585725383098,
  0.00020151710974876996,
  0.0002096047934157277,
  0.0004680865798606284,
  0.00043643942220402874,
  0.00045955931586469655,
  0.00032574646654771254,
  0.00032070422568487535,
  0.0002723585552231615,
  0.0002686969019314391,
  0.00026541602221863045,
  0.00024405238976237784,
  0.0002690032181377179,
  0.00025055720911743414,
  0.0002461817363861581,
  0.00024673033956802606,
  0.0002489148609306626,
  0.00024092942088554798,
  0.00026300275479939305,
  0.0002575577361659125,
  0.0002263660404615987,
  0.00022854644883068946,
  0.0001948637801409936,
  0.00022286741331099176,
  0.00021881525775487378,
  0.00020730612312128005,
  0.00019922317142017764,
  0.0002106423209152624,
  0.0001937771165249365,
  0.00020643066433257364,
  0.0002008719668712928,
  0.00019237338894491558,
  0.00018792880860031035,
  0.00018771574080785416,
  0.00019584417460056017,
  0.0001991795753341003,
  0.00020813812911828772,
  0.00020708107200883367,
  0.00020031426605868295,
  0.0002055777715214283,
  0.0001948890586612668,
  0.00021939174663669246,
  0.0002117143459356029,
  0.00022370677438643513,
  0.00021779231311392876,
  0.0002309675520474359,
  0.0002283503484300704,
  0.000492589026743866,
  0.0004568308976832353,
  0.00039599550266274986,
  0.00035391816464968386,
  0.00034710735994420577,
  0.000310571409190902,
  0.00026946852780939605,
  0.00024433451245367625,
  0.0002707673049030154,
  0.0002404592644654933,
  0.0002327800877342916,
  0.00024398479677139936,
  0.0002607439119219324,
  0.00023300398987472856,
  0.0002555874148730387,
  0.0002231415223809325,
  0.0002322138108309095,
  0.00025102431055217846,
  0.00022824839267056603,
  0.00022482730093632296,
  0.00020672239491871847,
  0.00018328193237959598,
  0.00019157238215190812,
  0.00019908276288780417,
  0.00019506833313707517,
  0.00018733947917816692,
  0.00021202865270770593,
  0.00021524312286907288,
  0.00018038291445962088,
  0.00017676284863639888,
  0.00021132059926795585,
  0.0002055417880661882,
  0.00019734251305815757,
  0.0001743536798209669,
  0.00020939486181488018,
  0.0002114207227380847,
  0.0002146481175787506,
  0.0002119685161447376,
  0.0001837017879044986,
  0.00018743850672576668,
  0.0002074918058438426,
  0.0001950841549790114,
  0.00020904511709764784,
  0.0001943279803240434,
  0.00021580077995388052,
  0.0002080730561690934,
  0.0002076710010649108,
  0.00021671016132767618,
  0.00019709817011781162,
  0.0002027607872706698,
  0.00020024927014514857,
  0.00020672060086834835,
  0.0002309500910051472,
  0.00048482965784988507,
  0.0004674311979821743,
  0.00040372562853103523,
  0.0003724680808212764,
  0.00032247611231371414,
  0.0002955691169265773,
  0.00028783765787860797,
  0.00031979281662994385,
  0.0002912175725564022,
  0.00024424046832551065,
  0.0002708491863007032,
  0.0002775801317309271,
  0.00023299845725594052,
  0.00022901481747290562,
  0.0002197787166332614,
  0.0001985638463038121,
  0.0002101291671081594,
  0.00021757838052402338,
  0.00021416364351621876,
  0.00021178154667650007,
  0.0001769012284444127,
  0.0002071754107415163,
  0.0002114614157171121,
  0.00021511856012035682,
  0.0002037515161060317,
  0.00019690474562870407,
  0.00019918128340407792,
  0.00019244986007417432,
  0.00018446177443640958,
  0.00020164928467767836,
  0.00018894863480386912,
  0.0002184789675083205,
  0.00021246014973784166,
  0.00021484351284961273,
  0.00023050084401594407,
  0.00047855134511230355,
  0.0004437276418315804,
  0.00040003002926159434,
  0.0003680682219857416,
  0.00025404682797200136,
  0.0002477618977419019,
  0.0002445566764788956,
  0.0002461953919776252,
  0.0002735197541529191,
  0.0002329358656724729,
  0.00026711627709193937,
  0.00027042079134058725,
  0.00024580366261784607,
  0.00022828298321268809,
  0.000225413698654941,
  0.0002002083465991755,
  0.0002213931021629025,
  0.00020326158290221284,
  0.0002048156937653914,
  0.00021423711593993866,
  0.00021846363333007516,
  0.00020761958885269263,
  0.00021409717873805092,
  0.00021783558292171872,
  0.00021631560841671555,
  0.0002057118425664852,
  0.0002186834640952807,
  0.00020087987183766323,
  0.000203864689368542,
  0.00020296022733738852,
  0.00018630535263512745,
  0.0001909324110043715,
  0.00019354134821432866,
  0.0002068310689818182,
  0.00021617548276783434,
  0.00020269858175096876,
  0.0002211590976297711,
  0.0002261887075221709,
  0.00020290715637311265,
  0.00020600602635844045,
  0.00021167386306702402,
  0.00023528694630057438,
  0.00047104248881903144,
  0.0004298671806014713,
  0.00034848833666032287,
  0.0002717678425272209,
  0.000283739692619466,
  0.00026849644337294704,
  0.00024069440776475586,
  0.00022792909458651246,
  0.0002746198992432774,
  0.00026344743370852974,
  0.00023846789459395037,
  0.0002341241780359544,
  0.00022796576905988043,
  0.00023408361358263522,
  0.0002577927093940078,
  0.00023234344530115872,
  0.00025673578628640763,
  0.00021888667455907077,
  0.00021326189610261718,
  0.00022372972128355465,
  0.00020302122915970118,
  0.00020127033279710373,
  0.00021927333816150411,
  0.00021292867755350273,
  0.0002169841658335495,
  0.00020855907600225642,
  0.00021362653859921958,
  0.00021671155039467774,
  0.00021414073658895493,
  0.00021448110007243743,
  0.00020619395397284332,
  0.00035407168317798024,
  0.0003737573408284832,
  0.0003815991057690912,
  0.0002194328601539502,
  0.00021126113177152893,
  0.0002054056363368125,
  0.0002114054223032478,
  0.00019662963218791988,
  0.00022620524968392446,
  0.00022716251251196835,
  0.00020701803644182864,
  0.00023832414334023775,
  0.00023570374876096063,
  0.0004936242307039256,
  0.0005008874445865387,
  0.0004987881968963418,
  0.000454423571913552,
  0.00043299916515746463,
  0.0004039409381393438,
  0.00028993874654093687,
  0.0003056676659953289,
  0.0002797703967201703,
  0.00027889568315659193,
  0.00027109142825509485,
  0.00026815857919730156,
  0.00023646989900288578,
  0.00023216303135617974,
  0.00020806156322725276,
  0.00020715839311273563,
  0.00021390372536674574,
  0.00022771576993049127,
  0.00023849221376701294,
  0.00025156311975653396,
  0.00020831596500247416,
  0.00021215041271337038,
  0.0002204255633521189,
  0.0002134169519207485,
  0.00021155013843693308,
  0.00035107824600993004,
  0.00038515106934470535,
  0.0003227215258586011,
  0.0003994267414881104,
  0.00040587644016793487,
  0.00020928466654789688,
  0.00033288041781442084,
  0.0003680703947488343,
  0.0003958342313438043,
  0.00021840370622569212,
  0.00022231991203276898,
  0.00020775347197660092,
  0.00019182181677096166,
  0.00022019346880026053,
  0.00022323515224011503,
  0.00021570608190538305,
  0.00022518737441733534,
  0.00021050182539955546,
  0.00022017624049791625,
  0.00021796752033351687,
  0.00024101367195080846,
  0.00023832527363578488,
  0.000503632251065675,
  0.00047727781379027233,
  0.0004609891814596501,
  0.0003856725323676667,
  0.0002596769888765666,
  0.00023180513597945344,
  0.0002248141976582217,
  0.00022220998178813767,
  0.00026377909438432046,
  0.00021410161647344094,
  0.00022968652284117646,
  0.00024077399771173672,
  0.00022078960215869554,
  0.00022384823723361742,
  0.00021593587589431733,
  0.0002117721358041025,
  0.00020749997948282933,
  0.0002975105921703266,
  0.0003269871316623249,
  0.0002994133405402456,
  0.0003139939216724202,
  0.00031737583633959426,
  0.0003294658150922287,
  0.0003543595463959959,
  0.00041393498911755546,
  0.00039878158280729354,
  0.00021293094512325628,
  0.0003774494782826511,
  0.00019702387347654893,
  0.00021489198322365317,
  0.00020101950058212646,
  0.00020386292342649008,
  0.00021779241288615,
  0.0002199491124709291,
  0.00023484160842145502,
  0.0002103664684613885,
  0.00021416229496911071,
  0.00022368961335334962,
  0.00022776964843339138,
  0.0005061701113219461,
  0.0004845695064637122,
  0.0003908862091443241,
  0.000356775318810615,
  0.0003334777403748549,
  0.0003341874365765048,
  0.000304998689892581,
  0.0002449441410515119,
  0.0002423099092163534,
  0.0002761673018530653,
  0.00028079664573006115,
  0.00021650153247470207,
  0.0002829571811634665,
  0.00022081208774272774,
  0.00023080248021315494,
  0.00023109588089876708,
  0.00021875886541004345,
  0.00023045213339867247,
  0.00021498388806971076,
  0.00021027289033857908,
  0.00025901919177296343,
  0.00024078671221461857,
  0.00025157071006659814,
  0.00024489469365698526,
  0.00021782058192957907,
  0.00021377891461567792,
  0.0002620664344594354,
  0.00026036111177190984,
  0.00026209615764793867,
  0.00020900989756630998,
  0.00027239311039243625,
  0.0002796771409639387,
  0.00029297036127149165,
  0.00035572319733929606,
  0.00021346342471381482,
  0.0004225066886135695,
  0.00022206350259231254,
  0.0004204287373611115,
  0.00021023906946195464,
  0.00021032580619965356,
  0.00030614781441345854,
  0.00027437550058159325,
  0.00043052067218247455,
  0.00022158047232672922,
  0.00021820411995549007,
  0.0003416833906779358,
  0.0004269416487810156,
  0.00020594391861474118,
  0.00034620060488255524,
  0.00037672278469688274,
  0.00041465356175870684,
  0.00023284995486699226,
  0.0002332323726910148,
  0.00021972163432454594,
  0.00021577161578990303,
  0.0002152758290198492,
  0.00023894466813732606,
  0.00021950324546062837,
  0.00023619770204550802,
  0.00042466269184215975,
  0.00037488607391809577,
  0.0003003789812309556,
  0.00024609257248382993,
  0.0002869648741774345,
  0.00021640823659621562,
  0.00021646218840134777,
  0.00021436147589927606,
  0.00022104774140382257,
  0.00021791879950005285,
  0.00026122295913236167,
  0.00021505252702217243,
  0.0002266755144537834,
  0.00021657792379842778,
  0.0002295896343204536,
  0.00024274865402102675,
  0.00021989783934526868,
  0.00022083733746111072,
  0.0002636557292629127,
  0.00026281884993372627,
  0.0002646336807886264,
  0.0002555415368646273,
  0.00025524114389854235,
  0.0002088282122686083,
  0.0002577255122026323,
  0.0002156566660238897,
  0.00027697483250299225,
  0.0003044963075247014,
  0.0003326266413538081,
  0.0002191205954385558,
  0.0002120177269611744,
  0.00025596167264917266,
  0.00042082863657708856,
  0.00040470162639091883,
  0.0002083985236868652,
  0.0004446488435389724,
  0.00045458411280314417,
  0.00020964787868269492,
  0.0004506449763059401,
  0.00019352940245649406,
  0.00022883553757297963,
  0.00023208763747875253,
  0.00023633568411705723,
  0.0002338388890831334,
  0.00044814878942722627,
  0.0003995029761896205,
  0.0002862617732293846,
  0.00023886667487118594,
  0.0002649002271144391,
  0.00022584415963479695,
  0.0002621490476188427,
  0.0002168301954488264,
  0.0002325613170190171,
  0.00023076621561532852,
  0.0002194030958930049,
  0.00026306111814992537,
  0.0002191658684518849,
  0.00026471507318123993,
  0.00021654778211774024,
  0.00022339338487157881,
  0.00021745345764173402,
  0.00022915902599551606,
  0.000259966324257117,
  0.00020849065821372393,
  0.00026457406252075204,
  0.00025883381979967664,
  0.00021930354386382153,
  0.00026214571657280845,
  0.0002635875352115152,
  0.000266602733341571,
  0.0002631179700061342,
  0.00025697924383927875,
  0.0002609317118873354,
  0.0002571542876495896,
  0.00031983848438777655,
  0.00026060453209644113,
  0.00021117882074105326,
  0.0002195236282388052,
  0.00022345153450550913,
  0.00021213692909023712,
  0.00028445021728066785,
  0.0004415644964506656,
  0.0002149528469996647,
  0.0003113450567907527,
  0.00022239911997871137,
  0.00046640855045513815,
  0.0003449265196353005,
  0.0002129046799596582,
  0.0004774985075816509,
  0.00019922766001181677,
  0.00038019706587825953,
  0.00019706423376235992,
  0.00021739886226839337,
  0.00022543681040504076,
  0.0002289067431934797,
  0.00023746041369981143,
  0.00022391688321705226,
  0.00021855726826674695,
  0.00021961187630663146,
  0.0002292178442094261,
  0.00023306827187975434,
  0.000508649719997113,
  0.00047126435369137463,
  0.0003990158219635763,
  0.0003732971065434158,
  0.0002663768140644715,
  0.0002917938749731196,
  0.00022082375526616513,
  0.00020671686633420892,
  0.00021169910677421684,
  0.00020964821784120866,
  0.0002658637651858694,
  0.00022816184665813393,
  0.0002688825112392039,
  0.00027258616417736415,
  0.0002619098501676952,
  0.0002208455421548181,
  0.00021436467697858732,
  0.00021935476852992747,
  0.00021524975899276275,
  0.0002655258715398927,
  0.0002239427068495667,
  0.0002592854692394666,
  0.00026343497965045646,
  0.0002587882551545605,
  0.0002614104985821019,
  0.00026655242313843144,
  0.0002532581769726192,
  0.0002581591356594534,
  0.0002628822068248438,
  0.00024399644033476744,
  0.00021775052765661885,
  0.0002611769935631919,
  0.0002706721661976996,
  0.0002701733870593791,
  0.00028883001968482876,
  0.00020674409359196312,
  0.00021507395487174318,
  0.00025403535696610766,
  0.00031003415040967955,
  0.0002075929945693273,
  0.00020433533896604204,
  0.00026268118445649057,
  0.0003760881576705622,
  0.00039594892604301367,
  0.00026394186270435024,
  0.0002599428857549487,
  0.0002622354493959575,
  0.0002202616882933266,
  0.0002672085094468217,
  0.00022558808477495795,
  0.00026754188719080513,
  0.00022791404327283845,
  0.0002702011989892223,
  0.0002876597656714381,
  0.00045629578690428653,
  0.0002180526384202751,
  0.0004942780933326304,
  0.0002156890260159447,
  0.000347524741178945,
  0.0004777395915061916,
  0.00042767320410709326,
  0.000235123613229884,
  0.00024012143116863168,
  0.00022509998799347822,
  0.0002249663139653633,
  0.00024244727723125896,
  0.0005006164747358289,
  0.000291540255574728,
  0.0002835381001332486,
  0.00020596475406335204,
  0.0002030672673974663,
  0.0002712984686273238,
  0.00023332721131515553,
  0.00023274680300822825,
  0.0002711203342463831,
  0.00028287515382957964,
  0.00021099749079053675,
  0.0002630677304859412,
  0.00025702069562911237,
  0.00025189233903925607,
  0.00025466839413360053,
  0.0002621834022583043,
  0.00023044937351453956,
  0.0002647422886029966,
  0.00025994940230857636,
  0.00025829555174782876,
  0.00022224864666715472,
  0.000259927308805903,
  0.0002550542576318646,
  0.000251946115132901,
  0.00020490475091587847,
  0.0002683252707557709,
  0.00023003012842916101,
  0.00021503225172119555,
  0.00025315941054004573,
  0.00026393798434733986,
  0.0002570231130692133,
  0.00024148574544606072,
  0.000262646994855401,
  0.0003492053224796177,
  0.00020663905441718384,
  0.0002159991637470008,
  0.0002201248248740928,
  0.00026511887171640767,
  0.00020822560919777386,
  0.00026804969713368825,
  0.00026399449797201847,
  0.0002646671684778046,
  0.00026214573644515814,
  0.0002689392356122324,
  0.000273870470383823,
  0.00022324672993737782,
  0.00022682075558001254,
  0.0003215130305512898,
  0.00048727376098981894,
  0.0004960399244121474,
  0.0003783436875486053,
  0.000504616366492491,
  0.00019878660874435124,
  0.0002376696081459788,
  0.00022324699358711685,
  0.0002222265671761483,
  0.0002463588565043276,
  0.0004657617258324693,
  0.00026528125651264324,
  0.00023342548891771601,
  0.0002367719518255069,
  0.00027655438314973105,
  0.00022809144756426964,
  0.000222394982101282,
  0.00022388921417988909,
  0.00020997333990318914,
  0.00022357844527001004,
  0.0002408874650351089,
  0.0002308079283991427,
  0.0002284400862511491,
  0.00021590248096791385,
  0.0002599417639018193,
  0.0002672168605896226,
  0.0002676176824429637,
  0.0002447291527572375,
  0.0002323775543040199,
  0.0003159782999346049,
  0.00027241482324793495,
  0.00026064329688998023,
  0.00025900577955227736,
  0.00024088569269097327,
  0.0002250800282669136,
  0.00022779200910349887,
  0.000273961393370479,
  0.0002662124136876157,
  0.0004408096846484007,
  0.0004740616833803021,
  0.00022386289638435486,
  0.00032081063998360847,
  0.00020827950487268824,
  0.0002252488630775668,
  0.00020352607603009256,
  0.00023806828916009455,
  0.00023888432934061405,
  0.0002428281024610417,
  0.0002272444769247129,
  0.00022186144703725767,
  0.0004883008272951805,
  0.0004458233633150582,
  0.00041727902846750846,
  0.0004139392180181282,
  0.0003694103107691933,
  0.00034157182244810044,
  0.0003182525926801226,
  0.0002950275030704981,
  0.0002474047475390925,
  0.0002390979022181551,
  0.00028377296930134086,
  0.00028294985008725374,
  0.00023628985811015575,
  0.0002356641215283511,
  0.0002326750845419482,
  0.0002367478405125458,
  0.0002383586631478549,
  0.0002598566676624926,
  0.00027178517479336476,
  0.0002460644952866969,
  0.0002349106806640991,
  0.0002632478826622236,
  0.00023482824516374195,
  0.00026680576687273367,
  0.0002691494299865416,
  0.0002695178138358613,
  0.00026883088290871295,
  0.00020946741436080266,
  0.00023319955368886937,
  0.0002161949835651715,
  0.0002765466505851127,
  0.0002955959290540698,
  0.00021252944216053598,
  0.0002047369360410398,
  0.00022033912715498726,
  0.00021452530827499787,
  0.0002480222589583474,
  0.0002256974146277446,
  0.00026557142595970635,
  0.00027683462083822225,
  0.0004523415520531939,
  0.0002663488674411498,
  0.00027372394306384606,
  0.00021524582539918314,
  0.00023102990660262443,
  0.0002363268051694358,
  0.0002772856157924219,
  0.0005084361201886089,
  0.00022696778226588365,
  0.0005138314579852047,
  0.0003510699776119061,
  0.0004927618067968295,
  0.00024143623705345752,
  0.00023216337022464553,
  0.00023715256153277644,
  0.00024272062414070828,
  0.00023270800226260184,
  0.00023697396448789897,
  0.0005081287539180631,
  0.00036003869636793144,
  0.00024307121438333463,
  0.0002817082861143026,
  0.00020141667269218372,
  0.00024044888406540526,
  0.00023665008708510535,
  0.0002877212511659484,
  0.0002053063575116582,
  0.00022833469909645416,
  0.00022820405720643411,
  0.0002519797925974836,
  0.00023836226129676853,
  0.00023907839057318565,
  0.00022650034307087572,
  0.0002230166256153578,
  0.0002625895178860117,
  0.00023181759336324305,
  0.00022945434841334768,
  0.0002603523907249894,
  0.000270914350676769,
  0.00022688709485139448,
  0.0002709643453745897,
  0.00029020683158910513,
  0.00022126681132111358,
  0.00022981146462894476,
  0.00027199252715273605,
  0.0003355819751185025,
  0.0003169754390676239,
  0.0002801098412864023,
  0.00020804632115663412,
  0.00024606673839197465,
  0.00021262524502354356,
  0.00021174575635848718,
  0.0002499208990677232,
  0.00023700972155000827,
  0.0002683424263201628,
  0.0002727990736977454,
  0.0002094595968067332,
  0.00026362896354713733,
  0.0002462928469835977,
  0.00026651101870548636,
  0.0002611253737368239,
  0.0005087269945213708,
  0.0002347972039463062,
  0.0003420740561268232,
  0.0005264339200326826,
  0.0002324749668782289,
  0.00037291684693152187,
  0.00020294936846119638,
  0.00024689242930706886,
  0.0002394569118320524,
  0.00023282995789140274,
  0.0002482152803775683,
  0.0005043497263027117,
  0.0003935912452624282,
  0.00027585176843783433,
  0.0002532357033430806,
  0.0002019271431013449,
  0.00024033573637324978,
  0.0002414150524513727,
  0.00027915799423727176,
  0.00022977628067875626,
  0.00023199258216109628,
  0.0002336828688916724,
  0.00023946239881152113,
  0.00024047649501667342,
  0.0002072630588775769,
  0.00021513575429566025,
  0.00020727236210952164,
  0.00022405243465644634,
  0.0002694700043560791,
  0.0003020815072987705,
  0.00022064622658779498,
  0.00022966024326510003,
  0.0002038565243139163,
  0.00027795748484305525,
  0.00022412319688771594,
  0.0004073239671934306,
  0.00023409566123452403,
  0.0002400762262157307,
  0.00028742222499159975,
  0.0002847693007693012,
  0.0002675438262647958,
  0.00027723640650957447,
  0.00024682998800776144,
  0.00022758804665820215,
  0.0002969411902937143,
  0.0003270893316287644,
  0.00024270099939010007,
  0.00040574559321513885,
  0.0004698230079745325,
  0.0002330501302540789,
  0.00022682160917069307,
  0.0005033145742390559,
  0.0003392787648707439,
  0.00030323935259706,
  0.0002986477367417678,
  0.00023504834887799641,
  0.0002156446507287354,
  0.0002901602586047627,
  0.0002384051254591677,
  0.00023468149874405063,
  ...])
#+end_example

<<b21a91a9-361e-4346-84f8-2273eb3ff86a>>
** Interacting with surface data in Napari
   :PROPERTIES:
   :CUSTOM_ID: interacting-with-surface-data-in-napari
   :END:
We now open Napari to interact with the data

<<e6ae4134-a40d-4996-bfaa-809d9065f2b4>>
#+begin_src python
viewer = napari.Viewer(ndisplay=3)
viewer.camera.angles = (40, -30, 55)
#+end_src

<<7d375a89-ac37-4769-83e9-8fdd63644f26>>
#+begin_src python
surface_layer = viewer.add_surface(surface, colormap='hsv')
#+end_src

<<8a699542-a866-4723-9b67-231101555bd6>>
#+begin_src python
surface_layer.properties = df.to_dict(orient='list')
surface_layer.features = df
#+end_src

<<59c87e62-f584-40f8-9075-b1d4fdb9caf6>>
#+begin_src python
from napari_skimage_regionprops import add_table
add_table(surface_layer, viewer)
#+end_src

#+begin_example
Napari status bar display of label properties disabled because https://github.com/napari/napari/issues/5417 and https://github.com/napari/napari/issues/4342
#+end_example

#+begin_example
<napari_skimage_regionprops._table.TableWidget at 0x2c7b7ebd5e0>
#+end_example

<<e9ace4e2-9476-47a6-b9ff-f4bbd5365bd5>>
#+begin_src python
viewer.window.add_dock_widget(nppas.SurfaceAnnotationWidget(viewer))
#+end_src

#+begin_example
<napari._qt.widgets.qt_viewer_dock_widget.QtViewerDockWidget at 0x2c7b92c8700>
#+end_example

<<cf7cbf79-bc7d-4602-a675-60adbf23009f>>
* Manual annotation
  :PROPERTIES:
  :CUSTOM_ID: manual-annotation
  :END:
Use the napari window and the Surface Annotation Widget to draw with
value 2 and 3 in concave and convex region on the surface.

<<a160e406-7b4a-48f4-94f0-3f6aef6d63bf>>
#+begin_src python
napari.utils.nbscreenshot(viewer)
#+end_src

[[file:c338314b9d84fab94f54fe4fafe34e800469171b.png]]

<<e50f0225-d447-4b05-8a26-c7f2d570325a>>
#+begin_src python
from napari_accelerated_pixel_and_object_classification._surface_vertex_classifier import SurfaceVertexClassifierWidget
viewer.window.add_dock_widget(SurfaceVertexClassifierWidget(viewer))
#+end_src

#+begin_example
<napari._qt.widgets.qt_viewer_dock_widget.QtViewerDockWidget at 0x2c7b9330d30>
#+end_example

#+begin_example
Selected surface layer: surface
Selected measurements: ['Quality.AREA', 'Quality.ASPECT_RATIO', 'Quality.GAUSS_CURVATURE', 'Quality.MEAN_CURVATURE', 'Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL', 'Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL']
selected properties       Quality.AREA  Quality.ASPECT_RATIO  Quality.GAUSS_CURVATURE  \
0        29.997389              1.600400                 0.030287   
1        46.087046              1.602183                 0.011136   
2        35.886338              1.400599                 0.012633   
3        22.887296              1.751932                 0.036979   
4        29.952347              1.220882                 0.010277   
...            ...                   ...                      ...   
3319     25.079661              1.340802                 0.031878   
3320     47.213916              1.254924                 0.004615   
3321     35.964707              1.140267                 0.015661   
3322     45.673529              1.189562                 0.011380   
3323     30.105530              1.151230                 0.014396   

      Quality.MEAN_CURVATURE  Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL  \
0                   0.000490                                     0.000257   
1                   0.000018                                     0.000250   
2                   0.000142                                     0.000253   
3                   0.000548                                     0.000379   
4                   0.000047                                     0.000391   
...                      ...                                          ...   
3319                0.000606                                     0.000168   
3320                0.000003                                     0.000169   
3321                0.000198                                     0.000163   
3322                0.000100                                     0.000152   
3323                0.000190                                     0.000163   

      Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL  
0                                       0.000019  
1                                       0.000019  
2                                       0.000019  
3                                       0.000019  
4                                       0.000019  
...                                          ...  
3319                                    0.000019  
3320                                    0.000019  
3321                                    0.000019  
3322                                    0.000019  
3323                                    0.000019  

[3324 rows x 6 columns]
As there are no 0 in the annotated classes, the minimum is subtracted
annotated classes [0. 0. 0. ... 0. 0. 0.]
RFC predictions finished. [2. 2. 3. ... 3. 2. 3.]
#+end_example

<<7c279bfe-8eee-4885-90f4-f4a39b0101cb>>
* Train classifier
  :PROPERTIES:
  :CUSTOM_ID: train-classifier
  :END:
Next, we can use the Surface Vertex Classification widget to train a
classifier.

<<a045faa1-10b8-42eb-bb44-1b14ff905f13>>
#+begin_src python
napari.utils.nbscreenshot(viewer)
#+end_src

[[file:785e2c659eda6f640c0646d7c1609606f8c7a3c4.png]]

<<608df7c4-02e3-4c44-9815-dfb3ff8c2ad4>>
** Apply classifier
   :PROPERTIES:
   :CUSTOM_ID: apply-classifier
   :END:
The classifier is an [[https://github.com/haesleinhuepf/apoc][apoc]]
TableRowClassifier, which can be applied to the table/DataFrame above.

<<c0dab42f-4b75-4687-96a6-42a08509b42e>>
#+begin_src python
table_row_classifier = apoc.TableRowClassifier(opencl_filename='table_row_classifier.cl')
#+end_src

<<7f31c331-076d-44e2-9748-97329e0e7083>>
#+begin_src python
result = table_row_classifier.predict(df)
#+end_src

<<30b49237-5645-4cd1-974a-879e659613e4>>
#+begin_src python
result
#+end_src

#+begin_example
array([1, 1, 2, ..., 2, 1, 2], dtype=uint32)
#+end_example

<<54f4a651-ed74-442d-9de4-f35b4d654351>>
#+begin_src python
df['classification'] = result
df
#+end_src

#+begin_example
      vertex_index  Quality.AREA  Quality.ASPECT_RATIO  \
0                0     29.997389              1.600400   
1                1     46.087046              1.602183   
2                2     35.886338              1.400599   
3                3     22.887296              1.751932   
4                4     29.952347              1.220882   
...            ...           ...                   ...   
3319          3319     25.079661              1.340802   
3320          3320     47.213916              1.254924   
3321          3321     35.964707              1.140267   
3322          3322     45.673529              1.189562   
3323          3323     30.105530              1.151230   

      Quality.GAUSS_CURVATURE  Quality.MEAN_CURVATURE  \
0                    0.030287                0.000490   
1                    0.011136                0.000018   
2                    0.012633                0.000142   
3                    0.036979                0.000548   
4                    0.010277                0.000047   
...                       ...                     ...   
3319                 0.031878                0.000606   
3320                 0.004615                0.000003   
3321                 0.015661                0.000198   
3322                 0.011380                0.000100   
3323                 0.014396                0.000190   

      Quality.SPHERE_FITTED_CURVATURE_HECTA_VOXEL  \
0                                        0.000257   
1                                        0.000250   
2                                        0.000253   
3                                        0.000379   
4                                        0.000391   
...                                           ...   
3319                                     0.000168   
3320                                     0.000169   
3321                                     0.000163   
3322                                     0.000152   
3323                                     0.000163   

      Quality.SPHERE_FITTED_CURVATURE_KILO_VOXEL  _CLUSTER_ID  classification  
0                                       0.000019          2.0               1  
1                                       0.000019          2.0               1  
2                                       0.000019          3.0               2  
3                                       0.000019          3.0               2  
4                                       0.000019          3.0               2  
...                                          ...          ...             ...  
3319                                    0.000019          3.0               2  
3320                                    0.000019          2.0               1  
3321                                    0.000019          3.0               2  
3322                                    0.000019          2.0               1  
3323                                    0.000019          3.0               2  

[3324 rows x 9 columns]
#+end_example

<<dfd0c0ae-1fc2-4172-9466-59d914d5ad84>>
#+begin_src python
annotated_surface = nppas.set_vertex_values(surface, result)
annotated_surface.azimuth = -135
annotated_surface
#+end_src

#+begin_example
(array([[ 14.174363, 220.40599 , 224.08286 ],
        [ 13.983076, 208.15877 , 220.32153 ],
        [ 14.819012, 219.06023 , 229.4558  ],
        ...,
        [112.18208 , 356.98364 , 430.36832 ],
        [112.3784  , 360.45856 , 421.8425  ],
        [112.865425, 352.2561  , 422.1735  ]], dtype=float32),
 array([[   0,    1,    2],
        [   3,    4,    5],
        [   6,    4,    7],
        ...,
        [3318, 3317, 3316],
        [3316, 3323, 3318],
        [3318, 3323, 3319]], dtype=int64),
 array([1, 1, 2, ..., 2, 1, 2], dtype=uint32))
#+end_example

<<3f46cecd-d406-4b73-85df-3408b0fb0203>>
#+begin_src python
#+end_src
